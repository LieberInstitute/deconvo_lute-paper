---
title: "01_run"
author: "Sean Maden"
date: "2023-10-02"
output: html_document
---

```{r setup, include=FALSE}

libv <- c("ggplot2")
sapply(libv, library, character.only = TRUE)


knitr::opts_chunk$set(echo = TRUE)
setwd("..")
setwd("..")
load("./env/09_quality/01_run_script.RData")


```

# Low neuron proportion

```{r}
```

# High neuron proportion

```{r, include=TRUE}
sample.id.iter.high <- "Br3942_mid"

# DYNAMIC TITLE
varname <- "is.high.consensus"
dynamic.title <- paste0(
  
  "S_pseudobulk id :", sample.id.iter.high, "; ",
  "varname_facet: ", varname
  
)

# new plot object
new.plot.experiment.high <- 
  ggplot(na.omit(dfp.tall.high), 
         aes(x = neuron.true, 
             y = neuron.pred, 
             color = sample.id, 
             size = matched.id)) + 
  geom_point() + 
  geom_abline(slope = 1, intercept = 0) + 
  facet_wrap(~type) +
  ggtitle(dynamic.title) +
  facet_wrap(~is.high.consensus*type, ncol=2)

# evaluate the object, getting plot as side effect
new.plot.experiment.high
```

# Session info

```{r}
sessionInfo()
```
