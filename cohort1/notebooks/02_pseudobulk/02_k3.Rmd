---
title: "Pseudobulk k3 with and without cell size rescaling"
author: "Sean Maden"
date: "2023-09-17"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
setwd("..")
setwd("..")
list.files()
load("./env/02_pseudobulk/02_k3.RData")
```

# Figure 2C 

```{r}
new.plot <- ggplot(dfp.tall, aes(x = neuron.true, y = neuron.pred)) + geom_point() + 
  geom_abline(slope = 1, intercept = 0) + 
  geom_hline(yintercept = 0.5) + geom_vline(xintercept = 0.5) + theme_bw() +
  xlab("True proportion") + ylab("Predicted proportion") +
  xlim(0, 1) + ylim(0, 1) + facet_wrap(~type) + ggtitle("Neuron")
new.plot
```

```{r}
setwd("..")
setwd("..")
new.plot.name <- "fig2c.jpg"
jpeg(file.path("./figures/02_pseudobulk/", new.plot.name), 
     width = 6, height = 3, units = "in", res = 400)
new.plot
dev.off()
```

# Figure S1C

```{r}
# jitterbox -- jittered points and boxplots of absolute errors
dfp.ae1 <- data.frame(celltype = dfp.ct$celltype,
                      abs.error = dfp.ct$abs.error.withscale)
dfp.ae1$type <- "withscale"
dfp.ae2 <- data.frame(celltype = dfp.ct$celltype,
                      abs.error = dfp.ct$abs.error.noscale)
dfp.ae2$type <- "noscale"
dfp.ae <- rbind(dfp.ae1, dfp.ae2)
new.plot <- ggplot(dfp.ae, aes(x = celltype, y = abs.error)) + 
  geom_jitter(alpha = 0.5) + 
  geom_boxplot(color = "cyan", alpha = 0) + theme_bw() + facet_wrap(~type)
```

```{r}
setwd("..")
setwd("..")
new.plot.name <- "figs1c.jpg"
jpeg(file.path("./figures/02_pseudobulk/", new.plot.name), 
     width = 4, height = 2.5, units = "in", res = 400)
new.plot
dev.off()
```

