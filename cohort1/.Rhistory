mae@sampleMap %>% distinct(assay) %>% t() %>%
as.data.frame() %>% group_by(assay) %>% summarize(n())
mae@sampleMap %>% distinct(assay)
mae@sampleMap %>%
t() %>% as.data.frame() %>% distinct(assay)
mae@sampleMap %>%
t() %>% as.data.frame()
mae@sampleMap %>% as.data.frame() %>% distinct(assay)
mae@sampleMap %>% as.data.frame() %>%
distinct(assay, sample.id)
mae@sampleMap
mae@sampleMap %>% as.data.frame() %>%
distinct(assay, primary)
mae@sampleMap %>% as.data.frame() %>%
distinct(assay, primary) %>% summarize(n())
mae@sampleMap %>% as.data.frame() %>%
distinct(assay, primary) %>% group_by(primary) %>% summarize(n())
mae@sampleMap %>% as.data.frame() %>%
distinct(assay, primary) %>% group_by(assay) %>% summarize(n())
head(mae@sampleMap)
mae@sampleMap %>%
as.data.frame() %>%
filter(primary %in% sample.id.train) %>%
distinct(assay, primary) %>%
group_by(assay) %>%
summarize(n())
mae@sampleMap %>%
as.data.frame() %>%
filter(primary %in% sample.id.validate) %>%
distinct(assay, primary) %>%
group_by(assay) %>%
summarize(n())
rbind(df.samples.map.all,
rbind(
df.samples.map.train,
df.samples.map.validate
))
df.samples.map.all <- mae@sampleMap %>%
as.data.frame() %>%
distinct(assay, primary) %>%
group_by(assay) %>%
summarize(n())
df.samples.map.train <- mae@sampleMap %>%
as.data.frame() %>%
filter(primary %in% sample.id.train) %>%
distinct(assay, primary) %>%
group_by(assay) %>%
summarize(n())
df.samples.map.validate <- mae@sampleMap %>%
as.data.frame() %>%
filter(primary %in% sample.id.validate) %>%
distinct(assay, primary) %>%
group_by(assay) %>%
summarize(n())
df.samples.map.all$data.type <- "all"
df.samples.map.train$data.type <- "train"
df.samples.map.validate$data.type <- "validate"
rbind(df.samples.map.all,
rbind(
df.samples.map.train,
df.samples.map.validate
))
new.table <- rbind(df.samples.map.all,
rbind(
df.samples.map.train,
df.samples.map.validate
))
colnames(new.table) <- c("platform", "unique_sample_source_count", "dataset_type")
new.table <- new.table[,c(3,1,2)]
save(new.table, file = "./outputs/01_mae/table2_platforms.rda")
write.csv(new.table, file = "./outputs/01_mae/table2_platforms.csv")
save(new.table, file = "./outputs/01_mae/table2_platforms.rda")
write.csv(new.table, file = "./outputs/01_mae/table2_platforms.csv", row.names = FALSE)
save(new.table, file = "./outputs/01_mae/table2_platforms.rda")
write.csv(new.table, file = "./outputs/01_mae/table2_platforms.csv", row.names = FALSE)
names(mae)
new.table$platform
unique(names(mae))
head(new.table)
new.table$platform.name <-
new.table$dataset.name <-
new.table$assay.name <- "NA"
platform.names <- c(
"snrnaseq.k2.all", "snrnaseq.k3.all", "snrnaseq.k4.all",
"bulk.pb.k2", "bulk.pb.k3", "bulk.pb.k4"
)
platform.names
colnames(new.table)
platform.names.iter
new.table$platform.name <-
new.table$dataset.name <-
new.table$assay.name <- "NA"
platform.names.iter <- c(
"snrnaseq.k2.all", "snrnaseq.k3.all", "snrnaseq.k4.all",
"bulk.pb.k2", "bulk.pb.k3", "bulk.pb.k4"
)
table(new.table$platform)
new.table$platform.name <-
new.table$dataset.name <-
new.table$assay.name <- "NA"
platform.names.iter <- c(
"snrnaseq.k2.all", "snrnaseq.k3.all", "snrnaseq.k4.all",
"bulk.pb.k2", "bulk.pb.k3", "bulk.pb.k4"
)
new.table[new.table$platform %in% platform.names.iter,]$platform.name <- "snRNAseq"
platform.names.iter <- c(
"bulk.rnaseq", "bulk.rpkm.rnaseq"
)
new.table[new.table$platform %in% platform.names.iter,]$platform.name <- "bulk RNAseq"
platform.names.iter <- c(
"cell.sizes", "sce.img"
)
new.table[new.table$platform %in% platform.names.iter,]$platform.name <- "RNAscope"
new.table
new.table$platform.name <-
new.table$dataset.name <-
new.table$assay.type <- "NA"
platform.names.iter <- c(
"snrnaseq.k2.all", "snrnaseq.k3.all", "snrnaseq.k4.all",
"bulk.pb.k2", "bulk.pb.k3", "bulk.pb.k4"
)
new.table[new.table$platform %in% platform.names.iter,]$assay.type <- "snRNAseq"
platform.names.iter <- c(
"bulk.rnaseq", "bulk.rpkm.rnaseq"
)
new.table[new.table$platform %in% platform.names.iter,]$assay.type <- "bulk RNAseq"
platform.names.iter <- c(
"cell.sizes", "sce.img"
)
new.table[new.table$platform %in% platform.names.iter,]$assay.type <- "RNAscope"
new.table
new.table <- rbind(df.samples.map.all,
rbind(
df.samples.map.train,
df.samples.map.validate
))
colnames(new.table) <- c("platform", "unique_sample_source_count", "dataset_type")
new.table <- new.table[,c(3,1,2)]
new.table$platform.name <-
new.table$dataset.name <-
new.table$assay.type <- "NA"
platform.names.iter <- c(
"snrnaseq.k2.all", "snrnaseq.k3.all", "snrnaseq.k4.all",
"bulk.pb.k2", "bulk.pb.k3", "bulk.pb.k4"
)
new.table[new.table$platform %in% platform.names.iter,]$assay.type <- "snRNAseq"
new.table[new.table$platform %in% platform.names.iter,]$platform.name <- "10X Chromium"
platform.names.iter <- c(
"bulk.rnaseq", "bulk.rpkm.rnaseq"
)
new.table[new.table$platform %in% platform.names.iter,]$assay.type <- "bulk RNAseq"
new.table[new.table$platform %in% platform.names.iter,]$platform.name <- "Illumina HiSeq"
platform.names.iter <- c(
"cell.sizes", "sce.img"
)
new.table[new.table$platform %in% platform.names.iter,]$assay.type <- "fluorescent in situ hybridi"
new.table[new.table$platform %in% platform.names.iter,]$platform.name <- "RNAscope"
new.table
head(new.table)
new.table
gc()
gc()
gc()
gc()
gc()
#!/usr/bin/env R
# Author: Sean Maden
#
# Make data summaries table for manuscript.
#
#
#
#
#
library(dplyr)
# load
mae <- get(load("./outputs/01_mae/mae_analysis_append.rda"))
list.sample.id <- get(load("./outputs/00_preprocess/list_snrnaseq_sampleid.rda"))
sample.id.train <- list.sample.id[["train"]]
sample.id.validate <- list.sample.id[["validation"]]
# sample source summaries
# PLATFORM_TYPE X SAMPLE_SOURCE_ID_COUNT
df.samples.map.all <- mae@sampleMap %>%
as.data.frame() %>%
distinct(assay, primary) %>%
group_by(assay) %>%
summarize(n())
df.samples.map.train <- mae@sampleMap %>%
as.data.frame() %>%
filter(primary %in% sample.id.train) %>%
distinct(assay, primary) %>%
group_by(assay) %>%
summarize(n())
df.samples.map.validate <- mae@sampleMap %>%
as.data.frame() %>%
filter(primary %in% sample.id.validate) %>%
distinct(assay, primary) %>%
group_by(assay) %>%
summarize(n())
df.samples.map.all$data.type <- "all"
df.samples.map.train$data.type <- "train"
df.samples.map.validate$data.type <- "validate"
new.table <- rbind(df.samples.map.all,
rbind(
df.samples.map.train,
df.samples.map.validate
))
colnames(new.table) <- c("platform", "unique_sample_source_count", "dataset_type")
new.table <- new.table[,c(3,1,2)]
new.table$platform.name <-
new.table$assay.type <- "NA"
platform.names.iter <- c(
"snrnaseq.k2.all", "snrnaseq.k3.all", "snrnaseq.k4.all",
"bulk.pb.k2", "bulk.pb.k3", "bulk.pb.k4"
)
new.table[new.table$platform %in% platform.names.iter,]$assay.type <- "snRNAseq"
new.table[new.table$platform %in% platform.names.iter,]$platform.name <- "10X Chromium"
platform.names.iter <- c(
"bulk.rnaseq", "bulk.rpkm.rnaseq"
)
new.table[new.table$platform %in% platform.names.iter,]$assay.type <- "bulk RNAseq"
new.table[new.table$platform %in% platform.names.iter,]$platform.name <- "Illumina HiSeq"
platform.names.iter <- c(
"cell.sizes", "sce.img"
)
new.table[new.table$platform %in% platform.names.iter,]$assay.type <- "fluorescent in situ hybridi"
new.table[new.table$platform %in% platform.names.iter,]$platform.name <- "RNAscope"
# save
save(new.table, file = "./outputs/01_mae/table2_platforms.rda")
write.csv(new.table, file = "./outputs/01_mae/table2_platforms.csv", row.names = FALSE)
?select
gc()
gc()
#!/usr/bin/env R
# Author: Sean Maden
#
# Make data summaries table for manuscript.
#
#
#
#
#
library(dplyr)
# dataset names
path.data.pre.filter <- "./outputs/01_mae/mae_allsamples_append.rda"
path.data.post.filter <- "./outputs/01_mae/mae_analysis_append.rda"
#----------------------------
# PRE FILTER DATA SETS
#----------------------------
# load
mae <- get(load(path.data.pre.filter))
list.sample.id <- get(load("./outputs/00_preprocess/list_snrnaseq_sampleid.rda"))
sample.id.train <- list.sample.id[["train"]]
sample.id.validate <- list.sample.id[["validation"]]
# sample source summaries
# PLATFORM_TYPE X SAMPLE_SOURCE_ID_COUNT
df.samples.map.all <- mae@sampleMap %>%
as.data.frame() %>%
distinct(assay, primary) %>%
group_by(assay) %>%
summarize(n())
df.samples.map.train <- mae@sampleMap %>%
as.data.frame() %>%
filter(primary %in% sample.id.train) %>%
distinct(assay, primary) %>%
group_by(assay) %>%
summarize(n())
df.samples.map.validate <- mae@sampleMap %>%
as.data.frame() %>%
filter(primary %in% sample.id.validate) %>%
distinct(assay, primary) %>%
group_by(assay) %>%
summarize(n())
df.samples.map.all$data.type <- "all"
df.samples.map.train$data.type <- "train"
df.samples.map.validate$data.type <- "validate"
new.table <- rbind(df.samples.map.all,
rbind(
df.samples.map.train,
df.samples.map.validate
))
colnames(new.table) <- c("platform", "unique_sample_source_count", "dataset_type")
new.table <- new.table[,c(3,1,2)]
new.table$platform.name <-
new.table$assay.type <- "NA"
platform.names.iter <- c(
"snrnaseq.k2.all", "snrnaseq.k3.all", "snrnaseq.k4.all",
"bulk.pb.k2", "bulk.pb.k3", "bulk.pb.k4"
)
new.table[new.table$platform %in% platform.names.iter,]$assay.type <- "snRNAseq"
new.table[new.table$platform %in% platform.names.iter,]$platform.name <- "10X Chromium"
platform.names.iter <- c(
"bulk.rnaseq", "bulk.rpkm.rnaseq"
)
new.table[new.table$platform %in% platform.names.iter,]$assay.type <- "bulk RNAseq"
new.table[new.table$platform %in% platform.names.iter,]$platform.name <- "Illumina HiSeq"
platform.names.iter <- c(
"cell.sizes", "sce.img"
)
new.table[new.table$platform %in% platform.names.iter,]$assay.type <- "fluorescent in situ hybridi"
new.table[new.table$platform %in% platform.names.iter,]$platform.name <- "RNAscope"
# save
save(new.table, file = "./outputs/01_mae/table2_platforms.rda")
write.csv(new.table, file = "./outputs/01_mae/table2_platforms.csv", row.names = FALSE)
#----------------------------
# POST FILTER DATA SETS
#----------------------------
# load
mae <- get(load(path.data.post.filter))
list.sample.id <- get(load("./outputs/00_preprocess/list_snrnaseq_sampleid.rda"))
sample.id.train <- list.sample.id[["train"]]
sample.id.validate <- list.sample.id[["validation"]]
# sample source summaries
# PLATFORM_TYPE X SAMPLE_SOURCE_ID_COUNT
df.samples.map.all <- mae@sampleMap %>%
as.data.frame() %>%
distinct(assay, primary) %>%
group_by(assay) %>%
summarize(n())
df.samples.map.train <- mae@sampleMap %>%
as.data.frame() %>%
filter(primary %in% sample.id.train) %>%
distinct(assay, primary) %>%
group_by(assay) %>%
summarize(n())
df.samples.map.validate <- mae@sampleMap %>%
as.data.frame() %>%
filter(primary %in% sample.id.validate) %>%
distinct(assay, primary) %>%
group_by(assay) %>%
summarize(n())
df.samples.map.all$data.type <- "all"
df.samples.map.train$data.type <- "train"
df.samples.map.validate$data.type <- "validate"
new.table <- rbind(df.samples.map.all,
rbind(
df.samples.map.train,
df.samples.map.validate
))
colnames(new.table) <- c("platform", "unique_sample_source_count", "dataset_type")
new.table <- new.table[,c(3,1,2)]
new.table$platform.name <-
new.table$assay.type <- "NA"
platform.names.iter <- c(
"snrnaseq.k2.all", "snrnaseq.k3.all", "snrnaseq.k4.all",
"bulk.pb.k2", "bulk.pb.k3", "bulk.pb.k4"
)
new.table[new.table$platform %in% platform.names.iter,]$assay.type <- "snRNAseq"
new.table[new.table$platform %in% platform.names.iter,]$platform.name <- "10X Chromium"
platform.names.iter <- c(
"bulk.rnaseq", "bulk.rpkm.rnaseq"
)
new.table[new.table$platform %in% platform.names.iter,]$assay.type <- "bulk RNAseq"
new.table[new.table$platform %in% platform.names.iter,]$platform.name <- "Illumina HiSeq"
platform.names.iter <- c(
"cell.sizes", "sce.img"
)
new.table[new.table$platform %in% platform.names.iter,]$assay.type <- "fluorescent in situ hybridi"
new.table[new.table$platform %in% platform.names.iter,]$platform.name <- "RNAscope"
# save
save(new.table, file = "./outputs/01_mae/table2_platforms_prefilter.rda")
write.csv(new.table, file = "./outputs/01_mae/table2_platforms_prefilter.csv", row.names = FALSE)
#-----------------
# region summaries
#-----------------
# PLATFORM_TYPE X BRAIN_REGION
gc()
gc()
#!/usr/bin/env R
# Author: Sean Maden
#
# Make data summaries table for manuscript.
#
#
#
#
#
library(dplyr)
# dataset names
path.data.pre.filter <- "./outputs/01_mae/mae_allsamples_append.rda"
path.data.post.filter <- "./outputs/01_mae/mae_analysis_append.rda"
list.sample.id <- get(load("./outputs/00_preprocess/list_snrnaseq_sampleid.rda"))
sample.id.train <- list.sample.id[["train"]]
sample.id.validate <- list.sample.id[["validation"]]
#----------------------------
# PRE FILTER DATA SETS
#----------------------------
# load
mae <- get(load(path.data.pre.filter))
# sample source summaries
# PLATFORM_TYPE X SAMPLE_SOURCE_ID_COUNT
df.samples.map.all <- mae@sampleMap %>%
as.data.frame() %>%
distinct(assay, primary) %>%
group_by(assay) %>%
summarize(n())
df.samples.map.train <- mae@sampleMap %>%
as.data.frame() %>%
filter(primary %in% sample.id.train) %>%
distinct(assay, primary) %>%
group_by(assay) %>%
summarize(n())
df.samples.map.validate <- mae@sampleMap %>%
as.data.frame() %>%
filter(primary %in% sample.id.validate) %>%
distinct(assay, primary) %>%
group_by(assay) %>%
summarize(n())
df.samples.map.all$data.type <- "all"
df.samples.map.train$data.type <- "train"
df.samples.map.validate$data.type <- "validate"
new.table <- rbind(df.samples.map.all,
rbind(
df.samples.map.train,
df.samples.map.validate
))
colnames(new.table) <- c("platform", "unique_sample_source_count", "dataset_type")
new.table <- new.table[,c(3,1,2)]
new.table$platform.name <-
new.table$assay.type <- "NA"
platform.names.iter <- c(
"snrnaseq.k2.all", "snrnaseq.k3.all", "snrnaseq.k4.all",
"bulk.pb.k2", "bulk.pb.k3", "bulk.pb.k4"
)
new.table[new.table$platform %in% platform.names.iter,]$assay.type <- "snRNAseq"
new.table[new.table$platform %in% platform.names.iter,]$platform.name <- "10X Chromium"
platform.names.iter <- c(
"bulk.rnaseq", "bulk.rpkm.rnaseq"
)
new.table[new.table$platform %in% platform.names.iter,]$assay.type <- "bulk RNAseq"
new.table[new.table$platform %in% platform.names.iter,]$platform.name <- "Illumina HiSeq"
platform.names.iter <- c(
"cell.sizes", "sce.img"
)
new.table[new.table$platform %in% platform.names.iter,]$assay.type <- "fluorescent in situ hybridi"
new.table[new.table$platform %in% platform.names.iter,]$platform.name <- "RNAscope"
# save
save(new.table, file = "./outputs/01_mae/table2_platforms_prefilter.rda")
write.csv(new.table, file = "./outputs/01_mae/table2_platforms_prefilter.csv", row.names = FALSE)
gc()
gc()
#!/usr/bin/env R
# Author: Sean Maden
#
# Make data summaries table for manuscript.
#
#
#
#
#
library(dplyr)
# dataset names
path.data.pre.filter <- "./outputs/01_mae/mae_allsamples_append.rda"
path.data.post.filter <- "./outputs/01_mae/mae_analysis_append.rda"
list.sample.id <- get(load("./outputs/00_preprocess/list_snrnaseq_sampleid.rda"))
sample.id.train <- list.sample.id[["train"]]
sample.id.validate <- list.sample.id[["validation"]]
#----------------------------
# PRE FILTER DATA SETS
#----------------------------
# load
mae <- get(load(path.data.pre.filter))
# sample source summaries
# PLATFORM_TYPE X SAMPLE_SOURCE_ID_COUNT
df.samples.map.all <- mae@sampleMap %>%
as.data.frame() %>%
distinct(assay, primary) %>%
group_by(assay) %>%
summarize(n())
df.samples.map.train <- mae@sampleMap %>%
as.data.frame() %>%
filter(primary %in% sample.id.train) %>%
distinct(assay, primary) %>%
group_by(assay) %>%
summarize(n())
df.samples.map.validate <- mae@sampleMap %>%
as.data.frame() %>%
filter(primary %in% sample.id.validate) %>%
distinct(assay, primary) %>%
group_by(assay) %>%
summarize(n())
df.samples.map.all$data.type <- "all"
df.samples.map.train$data.type <- "train"
df.samples.map.validate$data.type <- "validate"
new.table <- rbind(df.samples.map.all,
rbind(
df.samples.map.train,
df.samples.map.validate
))
colnames(new.table) <- c("platform", "unique_sample_source_count", "dataset_type")
new.table <- new.table[,c(3,1,2)]
new.table$platform.name <-
new.table$assay.type <- "NA"
platform.names.iter <- c(
"snrnaseq.k2.all", "snrnaseq.k3.all", "snrnaseq.k4.all",
"bulk.pb.k2", "bulk.pb.k3", "bulk.pb.k4"
)
new.table[new.table$platform %in% platform.names.iter,]$assay.type <- "snRNAseq"
new.table[new.table$platform %in% platform.names.iter,]$platform.name <- "10X Chromium"
platform.names.iter <- c(
"bulk.rnaseq", "bulk.rpkm.rnaseq"
)
new.table[new.table$platform %in% platform.names.iter,]$assay.type <- "bulk RNAseq"
new.table[new.table$platform %in% platform.names.iter,]$platform.name <- "Illumina HiSeq"
platform.names.iter <- c(
"cell.sizes", "sce.img"
)
new.table[new.table$platform %in% platform.names.iter,]$assay.type <- "fluorescent in situ hybridization"
new.table[new.table$platform %in% platform.names.iter,]$platform.name <- "RNAscope"
# save
save(new.table, file = "./outputs/01_mae/table2_platforms_prefilter.rda")
write.csv(new.table, file = "./outputs/01_mae/table2_platforms_prefilter.csv", row.names = FALSE)
