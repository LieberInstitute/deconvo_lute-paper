})
setwd("C:/Users/User/Documents/GitHub/scib")
setwd("C:/Users/User/Documents/GitHub/scib-reproducibility")
list.files(recursive = T)
barplot(unique.extensions.vector)
list.files.results.vector <- list.files(recursive = T)
list.files.results.vector
?list.files
files.results.vector.extensions <- gsub("\\.", "", list.files.results.vector)
files.results.vector.extensions
files.results.vector.extensions <- gsub(".*\\.", "", list.files.results.vector)
unique(files.results.vector.extensions)
unique.file.extensions.vector <- unique(files.results.vector.extensions)
table(unique.file.extensions.vector)
table(files.results.vector.extensions)
barplot(files.results.vector.extensions)
files.results.vector.extensions
?barplot
barplot(table(files.results.vector.extensions))
barplot(table(files.results.vector.extensions)[1:5])
barplot(table(files.results.vector.extensions)[5:10])
?prop.table
table.frequency.extensions <- table(files.results.vector.extensions)
table.proportion.extensions <- prop.table(table.frequency.extensions)
# this could be better as pipes, e.g. table() %>% prop.table()
table.frequency.extensions <- table(files.results.vector.extensions)
table.proportion.extensions <- prop.table(table.frequency.extensions)
table.frequency.extensions <- table(files.results.vector.extensions)
table.proportion.extensions <- prop.table(table.frequency.extensions)
table.proportion.extensions
table.frequency.extensions <- table(files.results.vector.extensions)
table.proportion.extensions <- prop.table(table.frequency.extensions)
table.proportion.extensions
load("~/GitHub/scib-reproducibility/README.md")
gc()
setwd("C:/Users/User/Documents/GitHub")
setwd("C:/Users/User/Documents/GitHub")
# get the system load paths
dpath <- system.file("extdata", "glint_files",
package = "recountmethylation")  # local path to example data
res1.fname <- "glint_results_tutorialdata.epistructure.pcs.txt"
res1.fpath <- file.path(dpath, res1.fname)
res1 <- read.table(res1.fpath, sep = "\t")            # read in example dataset #1
# get the system load paths
dpath <- system.file("extdata", "glint_files",
package = "recountmethylation")  # local path to example data
res1.fname <- "glint_results_tutorialdata.epistructure.pcs.txt"
res1.fpath <- file.path(dpath, res1.fname)
res1 <- read.table(res1.fpath, sep = "\t")            # read in example dataset #1
library(recountmethylation)
BiocManager::install("recountmethylation")
# get the system load paths
dpath <- system.file("extdata", "glint_files",
package = "recountmethylation")  # local path to example data
res1.fname <- "glint_results_tutorialdata.epistructure.pcs.txt"
res1.fpath <- file.path(dpath, res1.fname)
res1 <- read.table(res1.fpath, sep = "\t")            # read in example dataset #1
res2.fpath <- file.path(dpath, "glint_results_minfidata.epistructure.pcs.txt")
res2 <- read.table(res2.fpath, sep = "\t")            # read in example dataset #2
?BiocManager
BiocManager::version()
library(basilisk)
?basilisk
basilisk
basiliskRun()
# get the system load paths
dpath <- system.file("extdata", "glint_files",
package = "recountmethylation")  # local path to example data
res1.fname <- "glint_results_tutorialdata.epistructure.pcs.txt"
res1.fpath <- file.path(dpath, res1.fname)
res1 <- read.table(res1.fpath, sep = "\t")            # read in example dataset #1
res2.fpath <- file.path(dpath, "glint_results_minfidata.epistructure.pcs.txt")
res2 <- read.table(res2.fpath, sep = "\t")            # read in example dataset #2
env.name <- "glint_env"          # name the new virtual environment
pkg.name <- "recountmethylation" # set env properties
pkgv <- c("python==2.7",         # python version (v2.7)
"numpy==1.15",         # numpy version (v1.15)
"pandas==0.22",        # pandas version (v0.22)
"scipy==1.2",          # scipy version (v1.2)
"scikit-learn==0.19",  # scikit-learn (v0.19)
"matplotlib==2.2",     # matplotlib (v2.2)
"statsmodels==0.9",    # statsmodels (v0.9)
"cvxopt==1.2")         # cvxopt (v1.2)
glint_env <- BasiliskEnvironment(envname = env.name, pkgname = pkg.name,
packages = pkgv)
proc <- basiliskStart(glint_env) # define run process
proc
env.name <- "glint_env"          # name the new virtual environment
pkg.name <- "recountmethylation" # set env properties
pkgv <- c("python==2.7",         # python version (v2.7)
"numpy==1.15",         # numpy version (v1.15)
"pandas==0.22",        # pandas version (v0.22)
"scipy==1.2",          # scipy version (v1.2)
"scikit-learn==0.19",  # scikit-learn (v0.19)
"matplotlib==2.2",     # matplotlib (v2.2)
"statsmodels==0.9",    # statsmodels (v0.9)
"cvxopt==1.2")         # cvxopt (v1.2)
glint_env <- BasiliskEnvironment(envname = env.name, pkgname = pkg.name,
packages = pkgv)
proc <- basiliskStart(glint_env) # define run process
gc()
if (!requireNamespace("AzureStor", quietly = TRUE))
install.packages("AzureStor")
library("AzureStor")
sas <- "sp=racwl&st=2023-09-15T12:09:46Z&se=2023-09-29T20:09:46Z&spr=https&sv=2022-11-02&sr=c&sig=zOoG6Bx3rapm0uCpasqlkXfAK%2BorckQyaVed9HFHiH4%3D"
url <- "https://bioconductorhubs.blob.core.windows.net"
ep <- storage_endpoint(url, sas = sas)
container <- storage_container(ep, "staginghub")
libv <- c("ggplot2", "dplyr")
sapply(libv, library, character.only = T)
knitr::opts_chunk$set(echo = TRUE)
subfolder <- gsub(".*\\/", "", getwd())
subfolder <- gsub(".*\\/", "", getwd())
setwd("..")
setwd("..")
# list.files()
scripts.path <- file.path("scripts", subfolder)
scripts <- file.path(scripts.path, list.files(scripts.path))
sapply(scripts, source)
gc()
# load results
setwd("..")
setwd("..")
load.filename <- "df-sopt-result_yvary-zsame_cohort1.rda"
load.path <- file.path("data", "outputs", "12_soptimize_yvary-zsame_dlpfc-cohort1", load.filename)
df.res <- get(load(load.path))
# load results
setwd("..")
setwd("..")
load.filename <- "df-sopt-result_yvary-zsame_cohort1.rda"
load.path <- file.path("data", "outputs", "04_experiment", load.filename)
df.res <- get(load(load.path))
# load results
setwd("..")
setwd("..")
load.filename <- "df-sopt-result_yvary-zsame_cohort1.rda"
load.path <- file.path("data", "outputs", "04_experiment", load.filename)
df.res <- get(load(load.path))
# postprocess df.res
df.res$glial.group.label <- as.character(df.res$s.glial)
df.res$neuron.group.label <- as.character(df.res$s.neuron)
# df.res$all.highlight.categories <- ifelse(df.res$minimum.error, "min",ifelse(,,ifelse(,,ifelse())))
df.res$all.highlight.categories <- ifelse(df.res$minimum.error, "min",
ifelse(df.res$maximum.error, "max",
ifelse(df.res$minimum.decile.error, "min.dec",
ifelse(df.res$maximum.decile.error, "max.dec", "mid"))))
df.res$all.highlight.sizes <- ifelse(df.res$minimum.error|df.res$maximum.error, "min/max", "min.dec/max.dec/mid")
# set standard column labels
df.res$cell.compartment.id <- df.res$library.preparation
df.res$library.preparation.id <- gsub(".*_", "", df.res$cell.compartment)
df.res$block.id <- df.res$sample.id.brnum
df.res$experiment.id <- paste0(df.res$cell.compartment.id,"_",df.res$library.preparation.id)
df.res$sample.experiment <- paste0(df.res$sample.id,"_",df.res$experiment.id)
df.res$block.experiment <- paste0(df.res$block.id,"_",df.res$experiment.id)
df.res$sample.compartment <- paste0(df.res$sample.id,"_",df.res$cell.compartment.id)
# set plot parameters
highlight.color.low <- "red"
highlight.color.high <- "blue"
background.color.highlights <- "gray"
# helper functions
text.to.make.new.dfp <- function(variable.name="sample.id", value.index=1, dfp.index=1){
text.vector1 <- paste0("id.to.get <- df.res[,'",variable.name,"'][",value.index,"]")
text.vector2 <- paste0("filter.variable.vector <- df.res[,'",variable.name,"']==id.to.get")
text.vector3 <- paste0("dfp",dfp.index," <- df.res[filter.variable.vector,]")
text.vector.list <- as.list(c(text.vector1, text.vector2, text.vector3))
return(paste0(text.vector.list, collapse = ";"))
}
# viz wrapper functions
source("deconvo_plots.R")
# dataset summaries function(s)
source("dataset_summaries.R")
## Get plot data for `[BLOCK_ID]-[EXPERIMENT_CONDITION]`
# Gets the first ID in the "sample-region-compartment-library" designation, saves as `dfp1`.
dfp1 <- parse(text=text.to.make.new.dfp("block.experiment")) %>% eval()
## Get plot data for `[SAMPLE]-[EXPERIMENT_CONDITION]` "sample-compartment-library" as
dfp2 <- parse(text=text.to.make.new.dfp("sample.experiment")) %>% eval()
## Get plot data for `[SAMPLE]-[COMPARTMENT]`
dfp3 <- parse(text=text.to.make.new.dfp("sample.compartment")) %>% eval()
## Get plot data for `[SAMPLE]`
dfp4 <- parse(text=text.to.make.new.dfp("sample.id")) %>% eval()
list.summaries.dfp1 <- get_data_summaries(dfp1, "block.experiment")
list.summaries.dfp2 <- get_data_summaries(dfp2, "sample.experiment")
list.summaries.dfp3 <- get_data_summaries(dfp3, "sample.compartment")
list.summaries.dfp4 <- get_data_summaries(dfp4, "sample.id")
list.summaries.dfp1
list.summaries.dfp2
list.summaries.dfp3
list.summaries.dfp4
list.plots.dfp1 <- deconvo_plots_list(dfp1, "anatomic.region")
list.plots.dfp1$heatmaps$heatmap6
list.plots.dfp2 <- deconvo_plots_list(dfp2, "anatomic.region")
list.plots.dfp2$heatmaps$heatmap6
list.plots.dfp3.byregion <- deconvo_plots_list(dfp3, "anatomic.region")
list.plots.dfp3.bylibraryprep <- deconvo_plots_list(dfp3, "library.preparation.id")
list.plots.dfp3.byregion$heatmaps$heatmap6
list.plots.dfp3.bylibraryprep$heatmaps$heatmap6
facet.variable.vector <- c("anatomic.region", "library.preparation.id", "cell.compartment")
results.list.dfp4 <- lapply(facet.variable.vector, function(facet.variable){
deconvo_plots_list(dfp4, facet.variable)
})
names(results.list.dfp4) <- facet.variable.vector
unpack_plot_type(results.list.dfp4, "heatmap1", "heatmaps")
unpack_plot_type(results.list.dfp4, "heatmap6", "heatmaps")
unpack_plot_type(results.list.dfp4, "lp1", "lineplots")
unpack_plot_type(results.list.dfp4, "lp2", "lineplots")
gc()
knitr::opts_chunk$set(echo = TRUE)
libv <- c("ggplot2")
sapply(libv, library, character.only = T)
# load the dataset
setwd("..")
setwd("..")
load.filename <- "df-result-pseudobulk_s-opt-bias_cohort1.rda"
load.path <- file.path("data", "outputs", "04_experiment", load.filename)
df.res <- get(load(load.path))
# load the dataset
setwd("..")
setwd("..")
load.filename <- "df-result_s-opt-bias_cohort1.rda"
load.path <- file.path("data", "outputs", "04_experiment", load.filename)
df.res <- get(load(load.path))
df.res$abs.bias.neuron <- abs(df.res$bias.neuron.true.pred)
setwd("C:/Users/User/Documents/GitHub/deconvo_method-paper/cohort1")
#!/usr/bin/env R
# Author: Sean Maden
#
# Run this script from: ./deconvo_method-paper/cohort1/
#
# Makes an object of type MultiAssayExperiment containing experiment data organizead on sample ID
# (BrNum + Position). Data types in the MultiAssayExperiment:
#
# * snRNAseq
#
# * bulk RNAseq
#
# * RNAscope image processing outputs from HALO
#
#
#-------------
# dependencies
#-------------
libv <- c("here", "nlme", "ggplot2", "gridExtra", "dplyr", "ggforce", "MultiAssayExperiment", "SingleCellExperiment")
sapply(libv, library, character.only = TRUE)
#--------------------
# load prepped assays
#--------------------
# load snrnaseq data
load("./outputs/00_preprocess/list-scef_markers-k2-k3-k4_ro1-dlpfc.rda")
load("./outputs/00_preprocess/list-sce-validate_k-2-3-4-markers_cohort1.rda")
# load bulk data
load("./outputs/00_preprocess/rse-gene-filter.rda")
load("./outputs/00_preprocess/rse-rpkmCounts_Human_DLPFC_Deconvolution_n113.rda")
# load rnascope image data
load("./outputs/00_preprocess/halo-outputs_updated.Rdata")
#------------------
# common sample ids
#------------------
sample.id.snrnaseq <- "Sample"
sample.id.halo <- "Sample"
sample.id.bulk <- "batch.id2"
#-----------------
# helper functions
#-----------------
make_sce_all <- function(sce.train, sce.validate){
# make_sce_all
#
# get combined set of train and validation snRNAseq data
#
#
# rowdata
shared.markers <- intersect(rownames(sce.train), rownames(sce.validate))
sce.train <- sce.train[rownames(sce.train) %in% shared.markers,]
sce.validate <- sce.validate[rownames(sce.validate) %in% shared.markers,]
sce.train <- sce.train[!duplicated(rownames(sce.train)),]
sce.validate <- sce.validate[!duplicated(rownames(sce.validate)),]
sce.train<- sce.train[order(match(rownames(sce.train), shared.markers)),]
sce.validate <- sce.validate[order(match(rownames(sce.validate), shared.markers)),]
# coldata
cd.sce <- colData(sce.train)
cd.sce.validate <- colData(sce.validate)
cn.cd.sce <- colnames(cd.sce)
cn.cd.sce.validate <- colnames(cd.sce.validate)
cd.keep <- intersect(cn.cd.sce, cn.cd.sce.validate)
colData(sce.train) <- cd.sce[,colnames(cd.sce) %in% cd.keep]
colData(sce.validate) <- cd.sce.validate[,colnames(cd.sce.validate) %in% cd.keep]
# assays
assays(sce.train) <- list(counts = assays(sce.train)[["counts"]])
assays(sce.validate) <- list(counts = assays(sce.validate)[["counts"]])
rowData(sce.train) <- rowData(sce.validate)
metadata(sce.train) <- metadata(sce.validate) <- list()
# checks
identical(names(assays(sce.train)), names(assays(sce.validate)))
identical(rowData(sce.train), rowData(sce.validate))
identical(rownames(sce.train), rownames(sce.validate))
identical(colnames(colData(sce.train)), colnames(colData(sce.validate)))
# make sce.all
metadata <- list(train = metadata(sce.train),
validate = metadata(sce.validate))
assays.all <- list(counts = cbind(counts(sce.train), counts(sce.validate)))
sce.all <- SingleCellExperiment(assays = assays.all,
rowData = rowData(sce.train))
colData(sce.all) <- rbind(colData(sce.train), colData(sce.validate))
metadata(sce.all) <- metadata
return(sce.all)
}
#------------------------------------
# snrnaseq: isolate snrnaseq sce data
#------------------------------------
# train
sce1 <- lscef[[1]]
sce2 <- lscef[[2]]
sce3 <- lscef[[3]]
rm(lscef)
# validate
lscef.validate <- list.sce.validate.markers
sce1.validate <- lscef.validate[[1]]
sce2.validate <- lscef.validate[[2]]
sce3.validate <- lscef.validate[[3]]
rm(lscef.validate)
rm(list.sce.validate.markers)
# all (train + validate)
sce1.all <- make_sce_all(sce1, sce1.validate)
sce2.all <- make_sce_all(sce2, sce2.validate)
sce3.all <- make_sce_all(sce3, sce3.validate)
#-------------------------------------------
# write the sample ids for train, validation
#-------------------------------------------
sample.id.train <- unique(sce1[[sample.id.snrnaseq]])
sample.id.validate <- unique(sce1.validate[[sample.id.snrnaseq]])
list.sample.id.snrnaseq <- list(train = sample.id.train, validation = sample.id.validate)
# save
save(list.sample.id.snrnaseq, file = "outputs/00_preprocess/list_snrnaseq_sampleid.rda")
#--------------------------------------------
# bulk: isolate bulk rnaseq marker expression
#--------------------------------------------
# match counts and rpkm data
rownames(rse.filter) <- rowData(rse.filter)$Symbol
rownames(rse.rpkm) <- rowData(rse.rpkm)$Symbol
rse.rpkm <- rse.rpkm[rownames(rse.rpkm) %in% rownames(rse.filter),]
dim(rse.rpkm)
# match coldata
colnames.counts <- colnames(rse.filter)
colnames.counts.filter <- !grepl("_Cyto|_Nuc", colnames(rse.filter))
colnames.counts[colnames.counts.filter] <- paste0(colnames.counts[colnames.counts.filter],"_Bulk")
colnames(rse.filter) <- colnames.counts
head(colnames(rse.filter))
head(rownames(colData(rse.filter)))
identical(colnames(rse.filter), colnames(rse.rpkm))
colData(rse.rpkm) <- colData(rse.filter)
# filter markers
marker.id.vector <- unique(c(rownames(sce1), rownames(sce2), rownames(sce3)))
rse.filter <- rse.filter[rownames(rse.filter) %in% marker.id.vector,]
rse.rpkm <- rse.rpkm[rownames(rse.rpkm) %in% marker.id.vector,]
#-----------------------------------
# rnascope: make sce with image data
#-----------------------------------
img <- halo.output.table
new.img.colnames <- paste0("cell", seq(nrow(img)))
img.data.colnames <- c("Nucleus_Area", "AKT3_Copies", "Cell_Area",
"DAPI_Nucleus_Intensity", "DAPI_Cytoplasm_Intensity")
img.coldata.colnames <- c("SAMPLE_ID", sample.id.halo, "cell_type", "Slide",
"XMin", "XMax", "YMin", "YMax")
img.list <- lapply(img.data.colnames, function(colname){
new.data <- img[,colname] %>% as.matrix() %>% t()
colnames(new.data) <- new.img.colnames
new.data
})
names(img.list) <- img.data.colnames
sce.img <- SingleCellExperiment(assays = img.list)
img.coldata <- DataFrame(img[,img.coldata.colnames])
rownames(img.coldata) <- new.img.colnames
colData(sce.img) <- img.coldata
rm(halo.output.table)
gc()
#--------------------------------------------------
# df.rn: get additional rnascope data.frame objects
#--------------------------------------------------
# update sce.img with klabel categories
# get true proportions from rnascope data
rnascope <- sce.img
cd <- colData(rnascope)
cd$k2 <- cd$k3 <- cd$k4 <- "NA"
# append k label categories
cd$k2 <- ifelse(grepl("Excit|Inhib", cd$cell_type), "neuron",
ifelse(grepl("Endo|Oligo|Micro", cd$cell_type), "glial", "NA"))
cd$k3 <- ifelse(grepl("Excit", cd$cell_type), "Excit",
ifelse(grepl("Inhib", cd$cell_type), "Inhib",
ifelse(grepl("Endo|Oligo|Micro", cd$cell_type), "glial", "NA")))
cd$k4 <- ifelse(grepl("Excit", cd$cell_type), "Excit",
ifelse(grepl("Inhib", cd$cell_type), "Inhib",
ifelse(grepl("Oligo", cd$cell_type), "Oligo",
ifelse(grepl("Micro|Endo", cd$cell_type), "non_oligo_glial", "NA"))))
# reassign coldata to sce.img
colData(sce.img) <- cd
# get data.frames of cell sizes, counts, proportions by klabel category
sample.id.vector <- unique(rnascope$Sample)
# filter na values
rnascope <- sce.img[,!sce.img$k2=="NA"]
# get all kdata
df.rnascope.kdata <- do.call(rbind, lapply(c("k2", "k3", "k4"), function(cell.type.variable){
do.call(rbind, lapply(sample.id.vector, function(sample.id){
rnf <- rnascope[,rnascope$Sample==sample.id]
# proportions
df.prop <- table(rnf[[cell.type.variable]], rnf$Sample) %>% prop.table()
# counts
df.count <- table(rnf[[cell.type.variable]], rnf$Sample)
# sizes
df.size <- aggregate(data.frame(area = assays(rnf)[["Nucleus_Area"]][1,]),
by = list(cell_type = rnf[[cell.type.variable]]), FUN = "median")
# combine and format output
df.iter <- cbind(df.prop, cbind(df.size, df.count))
df.iter <- df.iter[,c(1,2,3,5,8)]
colnames(df.iter) <- c("cell_type", "sample_id", "true_proportion", "cell_size", "cell_count")
df.iter$k.label <- cell.type.variable
df.iter
}))
}))
rownames(df.rnascope.kdata) <- paste0(df.rnascope.kdata$sample_id,";",
df.rnascope.kdata$cell_type, ";",
df.rnascope.kdata$k.label)
# make transpose
df.rnascope.kdata <- t(df.rnascope.kdata)
# save rnascope data objects
save(sce.img, file = "outputs/00_preprocess/sce_img.rda")
save(df.rnascope.kdata, file = "outputs/00_preprocess/df_rnascope_kdata.rda")
#-------------
# mae: coldata
#-------------
# coldata
unique.sample.id.vector <- unique(
c(
sce1[[sample.id.snrnaseq]],
sce1.validate[[sample.id.snrnaseq]],
rse.filter[[sample.id.bulk]], # bulk and rpkm have same sample ids ...
df.rnascope.kdata["sample_id",]
)
)
coldata <- DataFrame(
data.frame(
sample.id = unique.sample.id.vector))
#------------------------
# mae: make data mappings/maplist
#------------------------
# snrnaseq
sn.k2.map <- data.frame(colname = colnames(sce1.all), primary = sce1.all[[sample.id.snrnaseq]])
sn.k3.map <- data.frame(colname = colnames(sce2.all), primary = sce2.all[[sample.id.snrnaseq]])
sn.k4.map <- data.frame(colname = colnames(sce3.all), primary = sce3.all[[sample.id.snrnaseq]])
# bulk
bulk.map <- data.frame(colname = colnames(rse.filter),
primary = rse.filter[[sample.id.bulk]])
bulk.rpkm.map <- data.frame(colname = colnames(rse.rpkm),
primary = rse.rpkm[[sample.id.bulk]])
# rnascope data
image.map <- data.frame(colname = colnames(sce.img),
primary = sce.img[[sample.id.halo]])
dfrn.map <- data.frame(colname = colnames(df.rnascope.kdata),
primary = gsub(";.*", "", colnames(df.rnascope.kdata)))
# make mappings list, then map df
listmap <- list(
snrnaseq.k2.all = sn.k2.map, # snrnaseq
snrnaseq.k3.all = sn.k3.map,
snrnaseq.k4.all = sn.k4.map,
bulk.rnaseq = bulk.map, # bulk
bulk.rpkm.rnaseq = bulk.rpkm.map, # bulk, rpkm
cell.sizes = dfrn.map
)
dfmap <- listToMap(listmap) # make new sampleMap object
rownames(dfmap) <- dfmap$primary
# get object list
object.list <- list(
snrnaseq.k2.all = sce1.all,
snrnaseq.k3.all = sce2.all,
snrnaseq.k4.all = sce3.all,
bulk.rnaseq = rse.filter,
bulk.rpkm.rnaseq = rse.rpkm,
cell.sizes = df.rnascope.kdata %>% as.matrix()
)
experiment.list <- ExperimentList(object.list)
rownames(coldata) <- coldata$sample.id
# get mae datasets
mae <- prepMultiAssay(
ExperimentList = experiment.list,
sampleMap = dfmap, colData = coldata
)
# get final mae type object
mae.final <- MultiAssayExperiment(
mae$experiments,
mae$colData,
mae$sampleMap
)
#--------------
# mae summaries
#--------------
# summarize
complete.id <- colData(mae.final)[complete.cases(mae.final),]
length(complete.id) # 11
# upset plot of samples by assays
upsetSamples(mae.final)
# example: subset on one sample id
mae.final[,colData(mae.final)$sample.id=="Br8492_mid",]
# inspect, with basic summaries
names(mae.final)
colData(mae.final)
#-----
# save
#-----
# set new mae filename
new.mae.filename <- "mae_allsamples.rda"
mae.final.filepath <- here("outputs", "01_mae", new.mae.filename)
save(mae.final, file = mae.final.filepath)
mae.final.filepath <- here("cohort1", "outputs", "01_mae", new.mae.filename)
save(mae.final, file = mae.final.filepath)
