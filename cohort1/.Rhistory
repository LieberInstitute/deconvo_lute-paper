theme(axis.text.x = element_text(angle = 45, hjust = 1))
new.plot3 <- ggplot(dfp, aes(x = neuron, y = glial)) +
geom_point() +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
geom_abline(slope = 1, intercept = 0) +
geom_smooth(method = "lm")
new.plot1
new.plot2
new.plot3
filter.plot <- dfp.tall$size.type.label=="rnascope"
dfp <- dfp.tall[filter.plot,]
new.plot1 <- ggplot(dfp, aes(x = subject.id, y = neuron)) +
geom_jitter() +
geom_boxplot(alpha = 0, color = "cyan") +
facet_wrap(~size.type.label) +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
new.plot2 <- ggplot(dfp, aes(x = subject.id, y = glial)) +
geom_jitter() +
geom_boxplot(alpha = 0, color = "cyan") +
facet_wrap(~size.type.label) +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
new.plot3 <- ggplot(dfp, aes(x = neuron, y = glial)) +
geom_point() +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
geom_abline(slope = 1, intercept = 0) +
geom_smooth(method = "lm")
new.plot1
new.plot2
new.plot3
dfp <- dfp.wide
new.plot1 <- ggplot(dfp,
aes(x = sn.ratio.glial.neuron, y = rn.ratio.glial.neuron)) +
geom_point() +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
geom_abline(slope = 1, intercept = 0) +
geom_smooth(method = "lm")
new.plot1
colnameS(dfp)
colnames(dfp)
dfp <- dfp.wide
new.plot1 <- ggplot(dfp,
aes(x = sn.ratio.glial.neuron, y = rn.ratio.glial.neuron,
color = "sample.id")) +
geom_point() +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
geom_abline(slope = 1, intercept = 0) +
geom_smooth(method = "lm") +
facet_wrap(~br.region)
new.plot1
dfp <- dfp.wide
new.plot1 <- ggplot(dfp,
aes(x = sn.ratio.glial.neuron, y = rn.ratio.glial.neuron,
color = sample.id)) +
geom_point() +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
geom_abline(slope = 1, intercept = 0) +
geom_smooth(method = "lm") +
facet_wrap(~br.region)
new.plot1
head(dfp)
dfp <- dfp.wide
new.plot1 <- ggplot(dfp,
aes(x = sn.ratio.glial.neuron, y = rn.ratio.glial.neuron,
color = subject.id)) +
geom_point() +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
geom_abline(slope = 1, intercept = 0) +
geom_smooth(method = "lm") +
facet_wrap(~br.region)
new.plot1
dfp <- dfp.wide
new.plot1 <- ggplot(dfp,
aes(x = sn.ratio.glial.neuron, y = rn.ratio.glial.neuron,
color = br.region)) +
geom_point() +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
geom_abline(slope = 1, intercept = 0) +
geom_smooth(method = "lm")
new.plot1
dfp <- dfp.wide
new.plot1 <- ggplot(dfp,
aes(x = sn.ratio.glial.neuron, y = rn.ratio.glial.neuron,
color = br.region)) +
geom_point() +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
geom_abline(slope = 1, intercept = 0)
new.plot1
dfp <- dfp.wide
new.plot1 <- ggplot(dfp,
aes(x = sn.ratio.glial.neuron, y = rn.ratio.glial.neuron)) +
geom_point() +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
geom_abline(slope = 1, intercept = 0)
new.plot1
dfp <- dfp.wide
new.plot1 <- ggplot(dfp,
aes(x = sn.ratio.glial.neuron, y = rn.ratio.glial.neuron)) +
geom_point(size = 2, alpha = 0.5) +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
geom_abline(slope = 1, intercept = 0)
new.plot1
dfp <- dfp.wide
new.plot1 <- ggplot(dfp,
aes(x = sn.ratio.glial.neuron, y = rn.ratio.glial.neuron)) +
geom_point(size = 4, alpha = 0.5) +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
geom_abline(slope = 1, intercept = 0)
new.plot1
filter.plot <- dfp.tall$size.type.label=="rnascope"
dfp <- dfp.tall[filter.plot,]
new.plot1 <- ggplot(dfp, aes(x = subject.id, y = neuron)) +
geom_jitter() +
geom_boxplot(alpha = 0, color = "cyan") +
facet_wrap(~size.type.label) +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
new.plot2 <- ggplot(dfp, aes(x = subject.id, y = glial)) +
geom_jitter() +
geom_boxplot(alpha = 0, color = "cyan") +
facet_wrap(~size.type.label) +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
new.plot3 <- ggplot(dfp, aes(x = neuron, y = glial)) +
geom_point() +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
geom_abline(slope = 1, intercept = 0)
new.plot1
new.plot2
new.plot3
filter.plot <- dfp.tall$size.type.label=="rnascope"
dfp <- dfp.tall[filter.plot,]
new.plot1 <- ggplot(dfp, aes(x = subject.id, y = neuron)) +
geom_jitter() +
geom_boxplot(alpha = 0, color = "cyan") +
facet_wrap(~size.type.label) +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
new.plot2 <- ggplot(dfp, aes(x = subject.id, y = glial)) +
geom_jitter() +
geom_boxplot(alpha = 0, color = "cyan") +
facet_wrap(~size.type.label) +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
new.plot3 <- ggplot(dfp, aes(x = neuron, y = glial)) +
geom_point() +
geom_point(size = 4, alpha = 0.5) +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
geom_abline(slope = 1, intercept = 0)
new.plot1
new.plot2
new.plot3
filter.plot <- dfp.tall$size.type.label=="rnascope"
dfp <- dfp.tall[filter.plot,]
new.plot1 <- ggplot(dfp, aes(x = subject.id, y = neuron)) +
geom_jitter() +
geom_boxplot(alpha = 0, color = "cyan") +
facet_wrap(~size.type.label) +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
new.plot2 <- ggplot(dfp, aes(x = subject.id, y = glial)) +
geom_jitter() +
geom_boxplot(alpha = 0, color = "cyan") +
facet_wrap(~size.type.label) +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
new.plot3 <- ggplot(dfp, aes(x = neuron, y = glial)) +
geom_point(size = 4, alpha = 0.5) +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
geom_abline(slope = 1, intercept = 0)
new.plot1
new.plot2
new.plot3
filter.plot <- dfp.tall$size.type.label=="snrnaseq"
dfp <- dfp.tall[filter.plot,]
new.plot1 <- ggplot(dfp, aes(x = subject.id, y = neuron)) +
geom_jitter() +
geom_boxplot(alpha = 0, color = "cyan") +
facet_wrap(~size.type.label) +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
new.plot2 <- ggplot(dfp, aes(x = subject.id, y = glial)) +
geom_jitter() +
geom_boxplot(alpha = 0, color = "cyan") +
facet_wrap(~size.type.label) +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
new.plot3 <- ggplot(dfp, aes(x = neuron, y = glial)) +
geom_point() +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
geom_abline(slope = 1, intercept = 0)
new.plot1
new.plot2
new.plot3
filter.plot <- dfp.tall$size.type.label=="snrnaseq"
dfp <- dfp.tall[filter.plot,]
new.plot1 <- ggplot(dfp, aes(x = subject.id, y = neuron)) +
geom_jitter() +
geom_boxplot(alpha = 0, color = "cyan") +
facet_wrap(~size.type.label) +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
new.plot2 <- ggplot(dfp, aes(x = subject.id, y = glial)) +
geom_jitter() +
geom_boxplot(alpha = 0, color = "cyan") +
facet_wrap(~size.type.label) +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
new.plot3 <- ggplot(dfp, aes(x = neuron, y = glial)) +
geom_point() +
geom_point(size = 4, alpha = 0.5) +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
geom_abline(slope = 1, intercept = 0)
new.plot1
new.plot2
new.plot3
filter.plot <- dfp.tall$size.type.label=="snrnaseq"
dfp <- dfp.tall[filter.plot,]
new.plot1 <- ggplot(dfp, aes(x = subject.id, y = neuron)) +
geom_jitter() +
geom_boxplot(alpha = 0, color = "cyan") +
facet_wrap(~size.type.label) +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
new.plot2 <- ggplot(dfp, aes(x = subject.id, y = glial)) +
geom_jitter() +
geom_boxplot(alpha = 0, color = "cyan") +
facet_wrap(~size.type.label) +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
new.plot3 <- ggplot(dfp, aes(x = neuron, y = glial)) +
geom_point(size = 4, alpha = 0.5) +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
geom_abline(slope = 1, intercept = 0)
new.plot1
new.plot2
new.plot3
dfp <- dfp.wide
new.plot1 <- ggplot(dfp,
aes(x = sn.ratio.glial.neuron, y = rn.ratio.glial.neuron,
color = br.region)) +
geom_point(size = 4, alpha = 0.5) +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
geom_abline(slope = 1, intercept = 0)
new.plot1
dfp <- dfp.wide
new.plot1 <- ggplot(dfp,
aes(x = sn.ratio.glial.neuron, y = rn.ratio.glial.neuron,
color = br.region)) +
geom_point(size = 4, alpha = 0.5) +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
geom_abline(slope = 1, intercept = 0) +
xlab("snRNAseq") + ylab("RNAscope")
new.plot1
dfp <- dfp.wide
new.plot1 <- ggplot(dfp,
aes(x = sn.ratio.glial.neuron, y = rn.ratio.glial.neuron,
color = br.region)) +
geom_point(size = 4, alpha = 0.5) +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
geom_abline(slope = 1, intercept = 0) +
xlab("snRNAseq") + ylab("RNAscope") + ggtitle("Ratio (glial/neuron)")
new.plot1
dfp <- dfp.wide
new.plot1 <- ggplot(dfp,
aes(x = sn.ratio.glial.neuron, y = rn.ratio.glial.neuron,
color = subject.id)) +
geom_point(size = 4, alpha = 0.5) +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
geom_abline(slope = 1, intercept = 0) +
xlab("snRNAseq") + ylab("RNAscope") + ggtitle("Ratio (glial/neuron)")
new.plot1
dfp <- dfp.wide
new.plot1 <- ggplot(dfp,
aes(x = sn.ratio.glial.neuron, y = rn.ratio.glial.neuron,
color = subject.id)) +
geom_point(size = 4, alpha = 0.5) +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
geom_abline(slope = 1, intercept = 0) +
xlab("snRNAseq") + ylab("RNAscope") + ggtitle("Ratio (glial/neuron)") +
facet_wrap(~subject.id)
new.plot1
dfp <- dfp.wide
new.plot1 <- ggplot(dfp,
aes(x = sn.ratio.glial.neuron, y = rn.ratio.glial.neuron,
color = br.region)) +
geom_point(size = 4, alpha = 0.5) +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
geom_abline(slope = 1, intercept = 0) +
xlab("snRNAseq") + ylab("RNAscope") + ggtitle("Ratio (glial/neuron)") +
facet_wrap(~subject.id)
new.plot1
dfp <- dfp.wide
new.plot1 <- ggplot(dfp, aes(x = , y = )) +
geom_jitter() +
geom_boxplot(alpha = 0, color = "cyan")
new.plot1
head(dfp)
dim(dfp)
new.plot1
colnames(dfp)
dfp <- dfp.tall
head(dfp.tall)
dfp <- dfp.tall
dfp$ratio.glial.neuron <- dfp$glial/dfp$neuron
new.plot1 <- ggplot(dfp,
aes(x = size.type.label, y = ratio.glial.neuron)) +
geom_jitter() +
geom_boxplot(alpha = 0, color = "cyan")
new.plot1
new.plot1
dfp <- dfp.tall
dfp$ratio.glial.neuron <- dfp$glial/dfp$neuron
new.plot1 <- ggplot(dfp,
aes(x = size.type.label, y = ratio.glial.neuron)) +
geom_jitter() +
geom_boxplot(alpha = 0, color = "cyan") +
geom_hline(yintercept = 1)
new.plot1
head(dfp)
new.plot2 <- ggplot(dfp,
aes(x = size.type.label, y = ratio.glial.neuron,
color = subject.id)) +
geom_point() +
geom_line() +
geom_hline(yintercept = 1)
new.plot2
?geom_line
?geom_sebment
?geom_segment
head(dfp)
filter.plot <- dfp.tall$size.type.label=="snrnaseq"
dfp <- dfp.tall[filter.plot,]
new.plot1 <- ggplot(dfp, aes(x = subject.id, y = neuron)) +
geom_jitter() +
geom_boxplot(alpha = 0, color = "cyan") +
facet_wrap(~size.type.label) +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
new.plot2 <- ggplot(dfp, aes(x = subject.id, y = glial)) +
geom_jitter() +
geom_boxplot(alpha = 0, color = "cyan") +
facet_wrap(~size.type.label) +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
new.plot3 <- ggplot(dfp, aes(x = neuron, y = glial)) +
geom_point(size = 4, alpha = 0.5) +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
geom_abline(slope = 1, intercept = 0) +
ggtitle("snRNAseq")
new.plot1
new.plot2
new.plot3
new.plot1
new.plot2
new.plot3
filter.plot <- dfp.tall$size.type.label=="rnascope"
dfp <- dfp.tall[filter.plot,]
new.plot1 <- ggplot(dfp, aes(x = subject.id, y = neuron)) +
geom_jitter() +
geom_boxplot(alpha = 0, color = "cyan") +
facet_wrap(~size.type.label) +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
new.plot2 <- ggplot(dfp, aes(x = subject.id, y = glial)) +
geom_jitter() +
geom_boxplot(alpha = 0, color = "cyan") +
facet_wrap(~size.type.label) +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
new.plot3 <- ggplot(dfp, aes(x = neuron, y = glial)) +
geom_point(size = 4, alpha = 0.5) +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
geom_abline(slope = 1, intercept = 0) +
ggtitle("RNAscope")
new.plot1
new.plot2
new.plot3
new.plot1
new.plot2
new.plot3
filter.plot <- dfp.tall$size.type.label=="rnascope"
dfp <- dfp.tall[filter.plot,]
new.plot1 <- ggplot(dfp, aes(x = subject.id, y = neuron)) +
geom_point(size = 2, alpha = 0.5) +
geom_boxplot(alpha = 0, color = "cyan") +
facet_wrap(~size.type.label) +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
new.plot2 <- ggplot(dfp, aes(x = subject.id, y = glial)) +
geom_jitter() +
geom_boxplot(alpha = 0, color = "cyan") +
facet_wrap(~size.type.label) +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
new.plot3 <- ggplot(dfp, aes(x = neuron, y = glial)) +
geom_point(size = 4, alpha = 0.5) +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
geom_abline(slope = 1, intercept = 0) +
ggtitle("RNAscope")
new.plot1
new.plot2
new.plot3
new.plot1
filter.plot <- dfp.tall$size.type.label=="rnascope"
dfp <- dfp.tall[filter.plot,]
new.plot1 <- ggplot(dfp, aes(x = subject.id, y = neuron)) +
geom_point(size = 2, alpha = 0.5) +
geom_boxplot(alpha = 0, color = "cyan") +
facet_wrap(~size.type.label) +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
new.plot2 <- ggplot(dfp, aes(x = subject.id, y = glial)) +
geom_point(size = 2, alpha = 0.5) +
geom_boxplot(alpha = 0, color = "cyan") +
facet_wrap(~size.type.label) +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
new.plot3 <- ggplot(dfp, aes(x = neuron, y = glial)) +
geom_point(size = 4, alpha = 0.5) +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
geom_abline(slope = 1, intercept = 0) +
ggtitle("RNAscope")
new.plot1
new.plot2
new.plot3
new.plot2
new.plot1
new.plot3
new.plot1
new.plot2
new.plot1
filter.plot <- dfp.tall$size.type.label=="snrnaseq"
dfp <- dfp.tall[filter.plot,]
new.plot1 <- ggplot(dfp, aes(x = subject.id, y = neuron)) +
geom_jitter() +
geom_boxplot(alpha = 0, color = "cyan") +
facet_wrap(~size.type.label) +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
new.plot2 <- ggplot(dfp, aes(x = subject.id, y = glial)) +
geom_jitter() +
geom_boxplot(alpha = 0, color = "cyan") +
facet_wrap(~size.type.label) +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
new.plot3 <- ggplot(dfp, aes(x = neuron, y = glial)) +
geom_point(size = 4, alpha = 0.5) +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
geom_abline(slope = 1, intercept = 0) +
ggtitle("snRNAseq")
new.plot1
new.plot2
new.plot3
new.plot1
new.plot2
new.plot3
filter.plot <- dfp.tall$size.type.label=="rnascope"
dfp <- dfp.tall[filter.plot,]
new.plot1 <- ggplot(dfp, aes(x = subject.id, y = neuron)) +
geom_point(size = 2, alpha = 0.5) +
geom_boxplot(alpha = 0, color = "cyan") +
facet_wrap(~size.type.label) +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
new.plot2 <- ggplot(dfp, aes(x = subject.id, y = glial)) +
geom_point(size = 2, alpha = 0.5) +
geom_boxplot(alpha = 0, color = "cyan") +
facet_wrap(~size.type.label) +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
new.plot3 <- ggplot(dfp, aes(x = neuron, y = glial)) +
geom_point(size = 4, alpha = 0.5) +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
geom_abline(slope = 1, intercept = 0) +
ggtitle("RNAscope")
new.plot1
new.plot2
new.plot3
new.plot1
new.plot2
new.plot3
ggplot(dfp.tall, aes(x = br.region, y = ratio.glial.neuron)) +
geom_jitter() + geom_boxplot(alpha = 0, color = "cyan") + facet_wrap(~size.type.label) +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
geom_hline(yintercept = ratio.yintercept.ref)
ggplot(dfp.tall, aes(x = br.region, y = ratio.glial.neuron)) +
geom_jitter() + geom_boxplot(alpha = 0, color = "cyan") + facet_wrap(~size.type.label) +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
geom_hline(yintercept = ratio.yintercept.ref)
head(dfp.tall)
gc()
gc()
dim(dfp.wide)
knitr::opts_chunk$set(echo = TRUE)
libv <- c("dplyr", "ggplot2", "GGally", "ggcorrplot")
sapply(libv, library, character.only = TRUE)
setwd("..")
setwd("..")
load("./env/08_sizes/01_run_script.RData")
dfp.wide <- list.dfp$dfp.wide
dfp.tall <- list.dfp$dfp.tall
dim(dfp.wide$sn.neuron)
mean(dfp.wide$sn.neuron)
mean(dfp.wide$rn.neuron)
sd(dfp.wide$sn.neuron)
var(dfp.wide$sn.neuron)
median(dfp.wide$sn.neuron)
mean(dfp.wide$rn.neuron)
dfp.wide <- dfp.wide[order(dfp.wide$sn.neuron),]
dfp.wide$rank.sn.rnaseq <- seq(nrow(dfp.wide))
dfp.wide <- dfp.wide[order(dfp.wide$rn.neuron),]
dfp.wide$rank.rnascope <- seq(nrow(dfp.wide))
summary(dfp.wide$rank.snrnaseq - dfp.wide$rank.rnascope)
dfp.wide <- dfp.wide[order(dfp.wide$sn.neuron),]
dfp.wide$rank.snrnaseq <- seq(nrow(dfp.wide))
dfp.wide <- dfp.wide[order(dfp.wide$rn.neuron),]
dfp.wide$rank.rnascope <- seq(nrow(dfp.wide))
summary(dfp.wide$rank.snrnaseq - dfp.wide$rank.rnascope)
seq(nrow(dfp.wide))
ggplot(dfp.wide, aes(x = rank.snrnaseq, y = rank.rnascope)) + geom_point()
summary(dfp.wide$rank.snrnaseq - dfp.wide$rank.rnascope)
dfp.wide <- dfp.wide[order(dfp.wide$sn.neuron),]
dfp.wide$rank.snrnaseq <- seq(nrow(dfp.wide))
dfp.wide <- dfp.wide[order(dfp.wide$rn.neuron),]
dfp.wide$rank.rnascope <- seq(nrow(dfp.wide))
dfp.wide$rank.difference.snranseq.rnascope <- dfp.wide$rank.snrnaseq-dfp.wide$rank.rnascope
dfp.wide$abs.rank.difference.snranseq.rnascope <- dfp.wide$rank.snrnaseq-dfp.wide$rank.rnascope
summary(dfp.wide$abs.rank.difference.snranseq.rnascope)
dfp.wide <- dfp.wide[order(dfp.wide$sn.neuron),]
dfp.wide$rank.snrnaseq <- seq(nrow(dfp.wide))
dfp.wide <- dfp.wide[order(dfp.wide$rn.neuron),]
dfp.wide$rank.rnascope <- seq(nrow(dfp.wide))
dfp.wide$rank.difference.snranseq.rnascope <- dfp.wide$rank.snrnaseq-dfp.wide$rank.rnascope
dfp.wide$abs.rank.difference.snranseq.rnascope <- abs(dfp.wide$rank.difference.snranseq.rnascope)
summary(dfp.wide$abs.rank.difference.snranseq.rnascope)
sd(dfp.wide$abs.rank.difference.snranseq.rnascope)
