---
title: "01_run"
author: "Sean Maden"
date: "2023-11-16"
output:
  pdf_document: default
  html_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
setwd("..")
setwd("..")
load("./env/05_summaries/01_run_script.RData")
source("./source/00_cell_type_management.R")
```

```{r}
y <- experimentData$y.table
z <- experimentData$z
ptrue <- experimentData$p.true
```

Summaries of contents of input data types.

# Background

## Datasets for deconvolution

Details about the datasets used in NNLS and ABIS runs.

```{r}
df <- data.frame(
  label = c("y.table", "z", "p.true"),
  filename = 
    c("GSE107011_Processed_data_TPM.txt", 
      "abisseq_rnaseq_cell_types_references_k17.csv",
      "flow_cytometry_true_cell_type_proportions_s13.csv"),
  #deconvoLabel = 
  #  c("Y", "z", "p.true"),
  #varName = 
  #  c("experimentData$y.table", "experimentData$z", "experimentData$p.true"),
  description = 
    c("S13 RNA-seq TPM", 
      "ABIS-seq reference", 
      "S13 FC proportions"),
  s13_samples = c(13, 0, 12)
)

knitr::kable(df)
```

## Cell type labels

```{r}
rownames(ptrue)
```

## Sample ID labels

Sample ID labels for S13 samples.

```{r}
colnames(ptrue)
```

# Data types

## Z ref S4

This is the ABIS-seq reference from S4 cohort. It was available in the 
manuscript supplement.

## Y S13

This is the bulk expression from S13 cohort and purified cell population 
expression from S4 cohort. It was available from GEO GSE107011 as the file 
"GSE107011_Processed_data_TPM.txt".

## Ptrue S13

This is the true cell type proportions from flow cytometry, collected for 
12/13 of S13 cohort samples. It was available in the manuscript supplement.

# Session info

```{r}
sessionInfo()
```