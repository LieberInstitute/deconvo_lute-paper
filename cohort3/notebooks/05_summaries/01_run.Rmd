---
title: "01_run"
author: "Sean Maden"
date: "2023-11-16"
output:
  pdf_document: default
  html_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
setwd("..")
setwd("..")
load("./env/05_summaries/01_run_script.RData")
source("./source/00_cell_type_management.R")
```

```{r}
y <- experimentData$y.table
z <- experimentData$z
ptrue <- experimentData$p.true
```

Summaries of contents of input data types.

# Data types

## Z ref S4

This is the ABIS-seq reference from S4 cohort. It was available in the 
manuscript supplement.

## Y S13

This is the bulk expression from S13 cohort and purified cell population 
expression from S4 cohort. It was available from GEO GSE107011 as the file 
"GSE107011_Processed_data_TPM.txt".

## Ptrue S13

This is the true cell type proportions from flow cytometry, collected for 
12/13 of S13 cohort samples. It was available in the manuscript supplement.

# Summaries

## All cell types

Z ref S4

```{r}
data <- z
cellTypes <- colnames(data)
cellTypes
length(unique(cellTypes))
```

Ptrue S13

```{r}
data <- ptrue
cellTypes <- colnames(ptrue)
cellTypes
length(unique(cellTypes))
```

Y bulk S13

```{r}
data <- z
cellTypes <- colnames(data)
cellTypes
length(unique(cellTypes))
```

## Cell types by general category

Z ref S4

```{r}
zCellTypes <- colnames(z)
zSummaries <- cellCategorySummaries(zCellTypes)
zSummaries
```

Ptrue S13

```{r}
pCellTypes <- colnames(ptrue)
pSummaries <- cellCategorySummaries(pCellTypes)
pSummaries
```

Y bulk S13

```{r}
yCellTypes <- unique(experimentData$y.se)
ySummaries <- cellCategorySummaries(yCellTypes)
ySummaries
```

Aggregate Z, P, Y

```{r}
allSummaries <- rbind(
  zSummaries, rbind(pSummaries, ySummaries)
) |> as.data.frame()
allSummaries$data <- c(
  rep("Z", 3), rep("p", 3), rep("y", 3)
)
knitr::kable(allSummaries, align = "c")
```

Aggregate Z, P

```{r}
allSummaries <- rbind(zSummaries, pSummaries) |> as.data.frame()
allSummaries$data <- c(
  rep("Z", 3), rep("p", 3)
)
knitr::kable(allSummaries, align = "c")
```

# Session info

```{r}
sessionInfo()
```