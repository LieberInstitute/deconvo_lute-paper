plot()
setwd("C:/Users/User/Documents/GitHub/deconvo_method-paper/cohort3/outputs")
libv <- c("SummarizedExperiment", "biomaRt")
sapply(libv, library, character.only = TRUE)
source("./source/00_read_experiment_data.R")
setwd("C:/Users/User/Documents/GitHub/deconvo_method-paper/cohort3")
libv <- c("SummarizedExperiment", "biomaRt")
sapply(libv, library, character.only = TRUE)
source("./source/00_read_experiment_data.R")
experimentData <- getExperimentData()
experimentData
names(experimentData)
experimentData$p.true
summary(experimentData$p.true["Plasmablasts",])
experimentData$p.true["Plasmablasts",] |> as.numeric() |> summary()
1-experimentData$p.true["Plasmablasts",] |> as.numeric() |> summary()
pTrue <- experimentData$p.true
pTrue[!rownames(pTrue)=="Plasmablasts",] |> as.numeric() |> summary()
pTrue
pTrue[!rownames(pTrue)=="Plasmablasts",]
pTrue[!rownames(pTrue)=="Plasmablasts",] |> unlist() |> as.numeric() |> summary()
1-experimentData$p.true["Plasmablasts",]
1-experimentData$p.true["Plasmablasts",] |> as.numeric()
1-experimentData$p.true["Plasmablasts",] |> as.numeric() |> summary()
summary(1-experimentData$p.true["Plasmablasts",])
1-as.numeric(experimentData$p.true["Plasmablasts",])
summary(1-as.numeric(experimentData$p.true["Plasmablasts",]))
1-as.numeric(experimentData$p.true["Plasmablasts",]) |> summary()
summary(1-as.numeric(experimentData$p.true["Plasmablasts",]))
x <- experimentData$p.true["Plasmablasts",] |> as.numeric() |> summary()
x
x[1]
# plasmablasts
proportionsPlasmablast <-
experimentData$p.true["Plasmablasts",] |> as.numeric() |> summary()
# Min.   1st Qu.    Median      Mean   3rd Qu.      Max.
# 0.0007014 0.0014741 0.0020032 0.0031640 0.0049517 0.0077615
# non-plasmablasts
proportionsNonplasmablastsCombined <-
summary(1-as.numeric(experimentData$p.true["Plasmablasts",]))
proportionsNonplasmablastsCombined
# Min. 1st Qu.  Median    Mean 3rd Qu.    Max.
# 0.9922  0.9950  0.9980  0.9968  0.9985  0.9993
# range of non-plasmablast cell composition
proportionsNonplasmablastsAlltypes <- experimentData$p.true
pTrue[!rownames(pTrue)=="Plasmablasts",] |> unlist() |> as.numeric() |> summary()
proportionsNonplasmablastsAlltypes
proportionsNonplasmablastsAlltypes <- experimentData$p.true
proportionsNonplasmablastsAlltypes <-
pTrue[!rownames(pTrue)=="Plasmablasts",] |> unlist() |> as.numeric() |> summary()
proportionsNonplasmablastsAlltypes
proportionsTable <- rbind(proportionsPlasmablast,
rbind(proportionsNonplasmablastsCombined,
proportionsNonplasmablastsAlltypes)) |>
as.data.frame()
rownames(proportionsTable) <-
c("plasmablast", "nonplasmablast", "nonplasmablast_unbinned")
proportionsTable
# output proportions table
save(proportionsTable,
file = "./outputs/08_improvement/cellProportionsTable.rda")
proportionsTable
save(proportionsTable,
file = "./outputs/08_improvements/cellProportionsTable.rda")
data.table::fwrite(
proportionsTable,"./outputs/08_improvements/cellProportionsTable.rda")
save(proportionsTable,
file = "./outputs/08_improvements/cellProportionsTable.rda")
data.table::fwrite(
proportionsTable,"./outputs/08_improvements/cellProportionsTable.csv")
data.table::fwrite(
proportionsTable,"./outputs/08_improvements/cellProportionsTable.csv",
row.names = TRUE)
data.table::fwrite(
proportionsTable,"./outputs/08_improvements/cellProportionsTable.csv",
row.names = TRUE)
