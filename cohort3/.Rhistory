plotList <- lapply(
cellTypesVector, function(cellType){
dfPlotNew <- dfPlotTallTall[dfPlotTallTall$cellType==cellType,]
ggplot(dfPlotNew, aes(x = trueProportion, y = proportion)) +
geom_point() + geom_abline(slope=1,intercept=0) + facet_wrap(~condition) +
ggtitle(cellType)
}
)
names(plotList) <- cellTypesVector
for(item in seq(length(plotList))){plotList[[item]]}
cellTypesVector <- unique(dfPlotTallTall$cellType)
plotList <- lapply(
cellTypesVector, function(cellType){
dfPlotNew <- dfPlotTallTall[dfPlotTallTall$cellType==cellType,]
ggplot(dfPlotNew, aes(x = trueProportion, y = proportion)) +
geom_point() + geom_abline(slope=1,intercept=0) + facet_wrap(~condition) +
ggtitle(cellType)
}
)
names(plotList) <- cellTypesVector
for(index in seq(length(plotList))){plotList[[item]]}
cellTypesVector <- unique(dfPlotTallTall$cellType)
plotList <- lapply(
cellTypesVector, function(cellType){
dfPlotNew <- dfPlotTallTall[dfPlotTallTall$cellType==cellType,]
ggplot(dfPlotNew, aes(x = trueProportion, y = proportion)) +
geom_point() + geom_abline(slope=1,intercept=0) + facet_wrap(~condition) +
ggtitle(cellType)
}
)
names(plotList) <- cellTypesVector
for(index in seq(length(plotList))){plotList[[index]]}
cellTypesVector <- unique(dfPlotTallTall$cellType)
plotList <- lapply(
cellTypesVector, function(cellType){
dfPlotNew <- dfPlotTallTall[dfPlotTallTall$cellType==cellType,]
ggplot(dfPlotNew, aes(x = trueProportion, y = proportion)) +
geom_point() + geom_abline(slope=1,intercept=0) + facet_wrap(~condition) +
ggtitle(cellType)
}
)
names(plotList) <- cellTypesVector
plotList[[1]]
plotList[[2]]
plotList[[3]]
plotList[[4]]
plotList[[5]]
plotList[[6]]
cellTypesVector <- unique(dfPlotTallTall$cellType)
plotList <- lapply(
cellTypesVector, function(cellType){
dfPlotNew <- dfPlotTallTall[dfPlotTallTall$cellType==cellType,]
ggplot(dfPlotNew, aes(x = trueProportion, y = proportion)) +
geom_point() + geom_abline(slope=1,intercept=0) + facet_wrap(~condition) +
ggtitle(cellType) + xlim(0, 1) + ylim(0, 1)
}
)
names(plotList) <- cellTypesVector
plotList[[1]]
plotList[[2]]
plotList[[3]]
plotList[[4]]
plotList[[5]]
plotList[[6]]
cellTypesVector <- unique(dfPlotTallTall$cellType)
plotList <- lapply(
cellTypesVector, function(cellType){
dfPlotNew <- dfPlotTallTall[dfPlotTallTall$cellType==cellType,]
ggplot(dfPlotNew, aes(x = trueProportion, y = proportion)) +
geom_point() + geom_abline(slope=1,intercept=0) + facet_wrap(~condition) +
ggtitle(cellType)
}
)
names(plotList) <- cellTypesVector
plotList[[1]]
plotList[[2]]
plotList[[3]]
plotList[[4]]
plotList[[5]]
plotList[[6]]
plotList[[7]]
plotList[[8]]
plotList[[9]]
plotList[[10]]
plotList[[11]]
plotList[[12]]
plotList[[13]]
cellTypesVector <- unique(dfPlotTallTall$cellType)
plotList <- lapply(
cellTypesVector, function(cellType){
dfPlotNew <- dfPlotTallTall[dfPlotTallTall$cellType==cellType,]
ggplot(dfPlotNew, aes(x = trueProportion, y = proportion)) +
geom_point() + geom_abline(slope=1,intercept=0) + facet_wrap(~condition) +
ggtitle(cellType) + xlim(0, 1) + ylim(0, 1)
}
)
names(plotList) <- cellTypesVector
plotList[[1]]
plotList[[2]]
plotList[[3]]
plotList[[4]]
plotList[[5]]
plotList[[6]]
plotList[[7]]
plotList[[8]]
plotList[[9]]
plotList[[10]]
plotList[[11]]
plotList[[12]]
plotList[[13]]
length(plotList)
save.image("./env/08_improvement/01_run_script.RData")
save.image("./env/08_improvement/01_run_script.RData")
cellSizes
dfPlot <- data.frame(cellType = names(cellSizes), size = as.numeric(cellSizes))
ggplot(dfPlot, aes(x = cellType, y = size)) + geom_barplot(stat = "identity")
head(dfPlot)
dfPlot <- data.frame(cellType = names(cellSizes), size = as.numeric(cellSizes))
ggplot(dfPlot, aes(x = cellType, y = size)) + geom_bar(stat = "identity")
dfPlot <- data.frame(cellType = names(cellSizes), size = as.numeric(cellSizes))
ggplot(dfPlot, aes(x = cellType, y = size)) + geom_bar(stat = "identity") +
theme(axis.text.x = element_text(angle = 45))
dfPlot <- data.frame(cellType = names(cellSizes), size = as.numeric(cellSizes))
ggplot(dfPlot, aes(x = cellType, y = size)) + geom_bar(stat = "identity") +
theme(axis.text.x = element_text(angle = 45), hjust = 1)
dfPlot <- data.frame(cellType = names(cellSizes), size = as.numeric(cellSizes))
ggplot(dfPlot, aes(x = cellType, y = size)) + geom_bar(stat = "identity") +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
dfPlot <- data.frame(cellType = names(cellSizes), size = as.numeric(cellSizes))
dfPlot$cellType <- factor(dfPlot$cellType, levels = dfPlot$cellType[order(dfPlot$size)])
ggplot(dfPlot, aes(x = cellType, y = size)) + geom_bar(stat = "identity") +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
dfPlot <- data.frame(cellType = names(cellSizes), size = as.numeric(cellSizes))
dfPlot$cellType <- factor(dfPlot$cellType, levels = dfPlot$cellType[rev(order(dfPlot$size))])
ggplot(dfPlot, aes(x = cellType, y = size)) + geom_bar(stat = "identity") +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
cellTypesVector <- unique(dfPlotTallTall$cellType)
plotList <- lapply(
cellTypesVector, function(cellType){
dfPlotNew <- dfPlotTallTall[dfPlotTallTall$cellType==cellType,]
ggplot(dfPlotNew, aes(x = trueProportion, y = proportion)) +
geom_point() + geom_abline(slope=1,intercept=0) + facet_wrap(~condition) +
ggtitle(cellType)
}
)
names(plotList) <- cellTypesVector
#plotList[[1]]
#plotList[[2]]
#plotList[[3]]
#plotList[[4]]
#plotList[[5]]
#plotList[[6]]
#plotList[[7]]
#plotList[[8]]
#plotList[[9]]
#plotList[[10]]
#plotList[[11]]
#plotList[[12]]
#plotList[[13]]
#plotList[[14]]
#plotList[[15]]
#plotList[[16]]
#plotList[[17]]
plotList[["Plasmablast"]]
names(plotList)
cellTypesVector <- unique(dfPlotTallTall$cellType)
plotList <- lapply(
cellTypesVector, function(cellType){
dfPlotNew <- dfPlotTallTall[dfPlotTallTall$cellType==cellType,]
ggplot(dfPlotNew, aes(x = trueProportion, y = proportion)) +
geom_point() + geom_abline(slope=1,intercept=0) + facet_wrap(~condition) +
ggtitle(cellType)
}
)
names(plotList) <- cellTypesVector
#plotList[[1]]
#plotList[[2]]
#plotList[[3]]
#plotList[[4]]
#plotList[[5]]
#plotList[[6]]
#plotList[[7]]
#plotList[[8]]
#plotList[[9]]
#plotList[[10]]
#plotList[[11]]
#plotList[[12]]
#plotList[[13]]
#plotList[[14]]
#plotList[[15]]
#plotList[[16]]
#plotList[[17]]
plotList[["Plasmablasts"]]
cellTypesVector <- unique(dfPlotTallTall$cellType)
plotList <- lapply(
cellTypesVector, function(cellType){
dfPlotNew <- dfPlotTallTall[dfPlotTallTall$cellType==cellType,]
ggplot(dfPlotNew, aes(x = trueProportion, y = proportion)) +
geom_point() + geom_abline(slope=1,intercept=0) + facet_wrap(~condition) +
ggtitle(cellType) + xlim(0, 1) + ylim(0, 1)
}
)
names(plotList) <- cellTypesVector
#plotList[[1]]
#plotList[[2]]
#plotList[[3]]
#plotList[[4]]
#plotList[[5]]
#plotList[[6]]
#plotList[[7]]
#plotList[[8]]
#plotList[[9]]
#plotList[[10]]
#plotList[[11]]
#plotList[[12]]
#plotList[[13]]
#plotList[[14]]
#plotList[[15]]
#plotList[[16]]
#plotList[[17]]
plotList[["Plasmablast"]]
cellTypesVector <- unique(dfPlotTallTall$cellType)
plotList <- lapply(
cellTypesVector, function(cellType){
dfPlotNew <- dfPlotTallTall[dfPlotTallTall$cellType==cellType,]
ggplot(dfPlotNew, aes(x = trueProportion, y = proportion)) +
geom_point() + geom_abline(slope=1,intercept=0) + facet_wrap(~condition) +
ggtitle(cellType) + xlim(0, 1) + ylim(0, 1)
}
)
names(plotList) <- cellTypesVector
#plotList[[1]]
#plotList[[2]]
#plotList[[3]]
#plotList[[4]]
#plotList[[5]]
#plotList[[6]]
#plotList[[7]]
#plotList[[8]]
#plotList[[9]]
#plotList[[10]]
#plotList[[11]]
#plotList[[12]]
#plotList[[13]]
#plotList[[14]]
#plotList[[15]]
#plotList[[16]]
#plotList[[17]]
plotList[["Plasmablasts"]]
cellTypesVector <- unique(dfPlotTallTall$cellType)
plotList <- lapply(
cellTypesVector, function(cellType){
dfPlotNew <- dfPlotTallTall[dfPlotTallTall$cellType==cellType,]
ggplot(dfPlotNew, aes(x = trueProportion, y = proportion)) +
geom_point() + geom_abline(slope=1,intercept=0) + facet_wrap(~condition) +
ggtitle(cellType) + xlim(0, 0.2) + ylim(0, 0.2)
}
)
names(plotList) <- cellTypesVector
#plotList[[1]]
#plotList[[2]]
#plotList[[3]]
#plotList[[4]]
#plotList[[5]]
#plotList[[6]]
#plotList[[7]]
#plotList[[8]]
#plotList[[9]]
#plotList[[10]]
#plotList[[11]]
#plotList[[12]]
#plotList[[13]]
#plotList[[14]]
#plotList[[15]]
#plotList[[16]]
#plotList[[17]]
plotList[["Plasmablasts"]]
head(dfPlotTallTall)
knitr::kable(head(dfPlotTallTall))
dfPlotTallTall$bias.pred.true <-
dfPlotTallTall$proportion-dfPlotTallTall$trueProportion
head(dfPlotTallTall)
plotList <- lapply(
cellTypesVector, function(cellType){
dfPlotNew <- dfPlotTallTall[dfPlotTallTall$cellType==cellType,]
ggplot(dfPlotNew, aes(x = sample.id, y = bias.pred.true)) +
geom_bar(stat = "identity") +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
}
)
names(plotList) <- cellTypesVector
plotList$Plasmablasts
#dfPlot <- dfPlotTallTall
#dfPlot$bias.pred.true <- dfPlot$proportion-dfPlot$trueProportion
plotList <- lapply(
cellTypesVector, function(cellType){
dfPlotNew <- dfPlotTallTall[dfPlotTallTall$cellType==cellType,]
ggplot(dfPlotNew, aes(x = sample.id, y = bias.pred.true)) +
geom_bar(stat = "identity") +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
}
)
names(plotList) <- cellTypesVector
plotList[["Plasmablasts"]]
#dfPlot <- dfPlotTallTall
#dfPlot$bias.pred.true <- dfPlot$proportion-dfPlot$trueProportion
cellTypesVector <- unique(dfPlotTallTall$cellType)
plotList <- lapply(
cellTypesVector, function(cellType){
dfPlotNew <- dfPlotTallTall[dfPlotTallTall$cellType==cellType,]
ggplot(dfPlotNew, aes(x = sample.id, y = bias.pred.true)) +
geom_bar(stat = "identity") +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
}
)
names(plotList) <- cellTypesVector
plotList[["Plasmablasts"]]
dfPlotTallTall
head(dfPlotTallTall)
names(plotList)
dfPlotTallTall[dfPlotTallTall$cellType=="Plasmablasts",]
#dfPlot <- dfPlotTallTall
dfPlot$bias.true.pred <- dfPlot$trueProportion-dfPlot$proportion
gc()
gc()
gc()
gc()
gc()
libv <- c("ggplot2", "gridExtra")
sapply(libv, library, character.only = TRUE)
knitr::opts_chunk$set(echo = FALSE)
setwd("..")
setwd("..")
load("./env/08_improvement/01_run_script.RData")
df.def <- data.frame(
cell.type = c("B.Naive",
"Basophils.LD",
"MAIT",
"mDCs",
"Monocytes.C",
"Monocytes.NC.I",
"Neutrophils.LD",
"NK",
"pDCs",
"Plasmablasts",
"T.CD4.Naive",
"T.CD8.Memory",
"T.CD8.Naive",
"T.gd.non.Vd2",
"T.gd.Vd2"),
description = c("Naive B-cells",
"Low-density Basophils",
"Mucosal-associated invariant T cells (MAIT)",
"Myeloid Dendritic Cells",
"Monocytes, type C",
"Monocytes, types NC and I combined",
"Low-density Neutrophils",
"Natural Killer",
"Plasmacytoid Dendritic Cells",
"Plasmablasts",
"CD4+ Naive T-cell",
"CD8+ Memory T-cell",
"CD8+ Naive T-cell",
"T lymphocyte, gamma delta, non-Vdelta2",
"T lymphocyte, gamma delta, Vdelta2")
)
knitr::kable(df.def)
dfPlot <- data.frame(cellType = names(cellSizes), size = as.numeric(cellSizes))
dfPlot$cellType <- factor(dfPlot$cellType, levels = dfPlot$cellType[rev(order(dfPlot$size))])
ggplot(dfPlot, aes(x = cellType, y = size)) + geom_bar(stat = "identity") +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
knitr::kable(head(dfPlotTallTall))
cellTypesVector <- unique(dfPlotTallTall$cellType)
plotList <- lapply(
cellTypesVector, function(cellType){
dfPlotNew <- dfPlotTallTall[dfPlotTallTall$cellType==cellType,]
ggplot(dfPlotNew, aes(x = trueProportion, y = proportion)) +
geom_point() + geom_abline(slope=1,intercept=0) + facet_wrap(~condition) +
ggtitle(cellType)
}
)
names(plotList) <- cellTypesVector
#plotList[[1]]
#plotList[[2]]
#plotList[[3]]
#plotList[[4]]
#plotList[[5]]
#plotList[[6]]
#plotList[[7]]
#plotList[[8]]
#plotList[[9]]
#plotList[[10]]
#plotList[[11]]
#plotList[[12]]
#plotList[[13]]
#plotList[[14]]
#plotList[[15]]
#plotList[[16]]
#plotList[[17]]
plotList[["Plasmablasts"]]
cellTypesVector <- unique(dfPlotTallTall$cellType)
plotList <- lapply(
cellTypesVector, function(cellType){
dfPlotNew <- dfPlotTallTall[dfPlotTallTall$cellType==cellType,]
ggplot(dfPlotNew, aes(x = trueProportion, y = proportion)) +
geom_point() + geom_abline(slope=1,intercept=0) + facet_wrap(~condition) +
ggtitle(cellType) + xlim(0, 1) + ylim(0, 1)
}
)
names(plotList) <- cellTypesVector
#plotList[[1]]
#plotList[[2]]
#plotList[[3]]
#plotList[[4]]
#plotList[[5]]
#plotList[[6]]
#plotList[[7]]
#plotList[[8]]
#plotList[[9]]
#plotList[[10]]
#plotList[[11]]
#plotList[[12]]
#plotList[[13]]
#plotList[[14]]
#plotList[[15]]
#plotList[[16]]
#plotList[[17]]
plotList[["Plasmablasts"]]
cellTypesVector <- unique(dfPlotTallTall$cellType)
plotList <- lapply(
cellTypesVector, function(cellType){
dfPlotNew <- dfPlotTallTall[dfPlotTallTall$cellType==cellType,]
ggplot(dfPlotNew, aes(x = trueProportion, y = proportion)) +
geom_point() + geom_abline(slope=1,intercept=0) + facet_wrap(~condition) +
ggtitle(cellType) + xlim(0, 0.2) + ylim(0, 0.2)
}
)
names(plotList) <- cellTypesVector
#plotList[[1]]
#plotList[[2]]
#plotList[[3]]
#plotList[[4]]
#plotList[[5]]
#plotList[[6]]
#plotList[[7]]
#plotList[[8]]
#plotList[[9]]
#plotList[[10]]
#plotList[[11]]
#plotList[[12]]
#plotList[[13]]
#plotList[[14]]
#plotList[[15]]
#plotList[[16]]
#plotList[[17]]
plotList[["Plasmablasts"]]
#dfPlot <- dfPlotTallTall
dfPlot$bias.true.pred <- dfPlot$trueProportion-dfPlot$proportion
dfPlot <- dfPlotTallTall
dfPlot$bias.true.pred <- dfPlot$trueProportion-dfPlot$proportion
cellTypesVector <- unique(dfPlotTallTall$cellType)
plotList <- lapply(
cellTypesVector, function(cellType){
dfPlotNew <- dfPlotTallTall[dfPlotTallTall$cellType==cellType,]
ggplot(dfPlotNew, aes(x = sample.id, y = bias.pred.true)) +
geom_bar(stat = "identity") +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
}
)
names(plotList) <- cellTypesVector
plotList[["Plasmablasts"]]
plotList$Plasmablasts
dfPlot <- dfPlotTallTall
dfPlot$bias.true.pred <- dfPlot$trueProportion-dfPlot$proportion
cellTypesVector <- unique(dfPlotTallTall$cellType)
plotList <- lapply(
cellTypesVector, function(cellType){
dfPlotNew <- dfPlot[dfPlot$cellType==cellType,]
ggplot(dfPlotNew, aes(x = sample.id, y = bias.pred.true)) +
geom_bar(stat = "identity") +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
}
)
names(plotList) <- cellTypesVector
plotList[["Plasmablasts"]]
dfPlot <- dfPlotTallTall
dfPlot$bias.true.pred <- dfPlot$trueProportion-dfPlot$proportion
cellTypesVector <- unique(dfPlotTallTall$cellType)
plotList <- lapply(
cellTypesVector, function(cellType){
dfPlotNew <- dfPlot[dfPlot$cellType==cellType,]
ggplot(dfPlotNew, aes(x = sample.id, y = bias.true.pred)) +
geom_bar(stat = "identity") +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
}
)
names(plotList) <- cellTypesVector
plotList[["Plasmablasts"]]
dfPlot <- dfPlotTallTall
dfPlot$bias.true.pred <- dfPlot$trueProportion-dfPlot$proportion
cellTypesVector <- unique(dfPlotTallTall$cellType)
plotList <- lapply(
cellTypesVector, function(cellType){
dfPlotNew <- dfPlot[dfPlot$cellType==cellType,]
ggplot(dfPlotNew, aes(x = sample.id, y = bias.true.pred)) +
geom_bar(stat = "identity") +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
ylab("Bias (True - Pred)")
}
)
names(plotList) <- cellTypesVector
plotList[["Plasmablasts"]]
