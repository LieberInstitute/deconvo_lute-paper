plotK2.c2box.glial,
layout_matrix = layoutMatrix)
jpeg("./figures/01_multipanel/pseudobulk-k2-2cohort_multi.jpg", width = 10, height = 4, units = "in", res = 400)
jpeg("./figures/01_multipanel/pseudobulk-k2-2cohort_multi.jpg", width = 10, height = 4, units = "in", res = 400)
grid.arrange(plotK2.c1Scatter.neuron,
plotK2.c1box.neuron,
plotK2.c2Scatter.neuron,
plotK2.c2box.neuron,
plotK2.c1Scatter.glial,
plotK2.c1box.glial,
plotK2.c2Scatter.glial,
plotK2.c2box.glial,
layout_matrix = layoutMatrix)
dev.off()
head(dfp.tall.c1.k2)
dfp.c1 <- rbind(data.frame(true = dfp.tall.c1.k2$glial.true,
pred = dfp.tall.c1.k2$glial.pred,
cell.type = rep("glial", nrow(dfp.tall.c1.k2))),
data.frame(true = dfp.tall.c1.k2$neuron.true,
pred = dfp.tall.c1.k2$neuron.pred,
cell.type = rep("neuron", nrow(dfp.tall.c1.k2)))) |>
as.data.frame()
ggplot(dfp.c1, aes(x = glial.true, y = glial.pred)) +
geom_point() + theme_bw() + theme(axis.text.x = element_text(angle = 45,hjust=1)) +
facet_wrap(~type) + geom_abline(slope = 1) +
xlab("Known") + ylab("Predicted") + ggtitle("") + xlim(0,1) + ylim(0,1) +
facet_wrap(cell.type)
ggplot(dfp.c1, aes(x = true, y = pred)) +
geom_point() + theme_bw() + theme(axis.text.x = element_text(angle = 45,hjust=1)) +
facet_wrap(~type) + geom_abline(slope = 1) +
xlab("Known") + ylab("Predicted") + ggtitle("") + xlim(0,1) + ylim(0,1) +
facet_wrap(cell.type)
head(dfp.c1)
ggplot(dfp.c1, aes(x = true, y = pred)) +
geom_point() + theme_bw() +
theme(axis.text.x = element_text(angle = 45, hjust=1)) +
facet_wrap(~type) + geom_abline(slope = 1) +
xlab("Known") + ylab("Predicted") + ggtitle("") + xlim(0,1) + ylim(0,1) +
facet_wrap(cell.type)
ggplot(dfp.c1, aes(x = true, y = pred)) +
geom_point() + theme_bw() +
theme(axis.text.x = element_text(angle = 45, hjust=1)) +
facet_wrap(~type) + geom_abline(slope = 1) +
xlab("Known") + ylab("Predicted") + ggtitle("") + xlim(0,1) + ylim(0,1) +
facet_wrap(~cell.type)
ggplot(dfp.c1, aes(x = true, y = pred)) +
geom_point() + theme_bw() +
theme(axis.text.x = element_text(angle = 45, hjust=1)) +
facet_wrap(~type) + geom_abline(slope = 1) +
xlab("Known") + ylab("Predicted") + ggtitle("") + xlim(0,1) + ylim(0,1) +
facet_wrap(~cell.type)
head(dfp.c1)
head(dfp.tall.c1.k2)
ggplot(dfp.c1, aes(x = true, y = pred)) +
geom_point() + theme_bw() +
theme(axis.text.x = element_text(angle = 45, hjust=1)) +
geom_abline(slope = 1) +
xlab("Known") + ylab("Predicted") + ggtitle("") + xlim(0,1) + ylim(0,1) +
facet_wrap(~cell.type*type)
ggplot(dfp.c1, aes(x = true, y = pred)) +
geom_point() + theme_bw() + geom_abline(slope = 1) +
theme(axis.text.x = element_text(angle = 45, hjust=1)) +
xlab("Known") + ylab("Predicted") + ggtitle("") + xlim(0,1) + ylim(0,1) +
facet_wrap(~cell.type*type)
dfp.c1 <- rbind(data.frame(true = dfp.tall.c1.k2$glial.true,
pred = dfp.tall.c1.k2$glial.pred,
cell.type = rep("glial", nrow(dfp.tall.c1.k2)),
type = dfp.tall.c1.k2$type),
data.frame(true = dfp.tall.c1.k2$neuron.true,
pred = dfp.tall.c1.k2$neuron.pred,
cell.type = rep("neuron", nrow(dfp.tall.c1.k2)),
type = dfp.tall.c1.k2$type)) |>
as.data.frame()
ggplot(dfp.c1, aes(x = true, y = pred)) +
geom_point() + theme_bw() + geom_abline(slope = 1) +
theme(axis.text.x = element_text(angle = 45, hjust=1)) +
xlab("Known") + ylab("Predicted") + ggtitle("") + xlim(0,1) + ylim(0,1) +
facet_wrap(~cell.type*type)
dfp.c1 <- rbind(data.frame(true = dfp.tall.c1.k2$glial.true,
pred = dfp.tall.c1.k2$glial.pred,
cell.type = rep("glial", nrow(dfp.tall.c1.k2)),
type = dfp.tall.c1.k2$type,
error = dpf.tall.c1.k2$glial.abs.error),
data.frame(true = dfp.tall.c1.k2$neuron.true,
pred = dfp.tall.c1.k2$neuron.pred,
cell.type = rep("neuron", nrow(dfp.tall.c1.k2)),
type = dfp.tall.c1.k2$type,
error = dfp.tall.c1.k2$neuron.abs.error)) |>
as.data.frame()
dfp.c1 <- rbind(data.frame(true = dfp.tall.c1.k2$glial.true,
pred = dfp.tall.c1.k2$glial.pred,
cell.type = rep("glial", nrow(dfp.tall.c1.k2)),
type = dfp.tall.c1.k2$type,
error = dfp.tall.c1.k2$glial.abs.error),
data.frame(true = dfp.tall.c1.k2$neuron.true,
pred = dfp.tall.c1.k2$neuron.pred,
cell.type = rep("neuron", nrow(dfp.tall.c1.k2)),
type = dfp.tall.c1.k2$type,
error = dfp.tall.c1.k2$neuron.abs.error)) |>
as.data.frame()
ggplot(dfp.c1, aes(x = type, y = neuron.abs.error)) +
geom_boxplot(color="cyan") + geom_jitter(alpha = 0.5) + theme_bw() + theme(axis.text.x = element_text(angle = 45,hjust=1), axis.title.x = element_blank()) +
ylab("Error") + ggtitle("\n") + ylim(0, 0.3)
ggplot(dfp.c1, aes(x = type, y = neuron.abs.error)) +
geom_boxplot(color="cyan") + geom_jitter(alpha = 0.5) + theme_bw() +
theme(axis.text.x = element_text(angle = 45,hjust=1), axis.title.x = element_blank()) +
ylab("Error") + ggtitle("\n") + ylim(0, 0.3)
ggplot(dfp.c1, aes(x = type, y = error)) +
geom_boxplot(color="cyan") + geom_jitter(alpha = 0.5) + theme_bw() +
theme(axis.text.x = element_text(angle = 45,hjust=1), axis.title.x = element_blank()) +
ylab("Error") + ggtitle("\n") + ylim(0, 0.3)
ggplot(dfp.c1, aes(x = type, y = error)) +
geom_boxplot(color="cyan") + geom_jitter(alpha = 0.5) + theme_bw() +
theme(axis.text.x = element_text(angle = 45,hjust=1), axis.title.x = element_blank()) +
ylab("Error") + ggtitle("\n") + ylim(0, 0.3) + facet_wrap(~cell.type)
ggplot(dfp.c1, aes(x = type, y = error)) +
geom_boxplot(color="cyan") + geom_jitter(alpha = 0.5) + theme_bw() +
theme(axis.text.x = element_text(angle = 45,hjust=1), axis.title.x = element_blank()) +
ylab("Error") + ggtitle("\n") + ylim(0, 0.3) + facet_wrap(~cell.type, nrow = 2)
ggplot(dfp.c1, aes(x = true, y = pred)) +
geom_point() + theme_bw() + geom_abline(slope = 1) +
theme(axis.text.x = element_text(angle = 45, hjust=1)) +
xlab("Known") + ylab("Predicted") + ggtitle("") + xlim(0,1) + ylim(0,1) +
facet_wrap(~cell.type*type)
dfp.c2 <- rbind(data.frame(true = dfp.tall.c2.k2$glial.true,
pred = dfp.tall.c2.k2$glial.pred,
cell.type = rep("glial", nrow(dfp.tall.c2.k2)),
type = dfp.tall.c2.k2$type,
error = dfp.tall.c2.k2$glial.abs.error),
data.frame(true = dfp.tall.c2.k2$neuron.true,
pred = dfp.tall.c2.k2$neuron.pred,
cell.type = rep("neuron", nrow(dfp.tall.c2.k2)),
type = dfp.tall.c2.k2$type,
error = dfp.tall.c2.k2$neuron.abs.error)) |>
as.data.frame()
dfp.c2 <- ggplot(dfp.c2, aes(x = true, y = pred)) +
geom_point() + theme_bw() + geom_abline(slope = 1) +
theme(axis.text.x = element_text(angle = 45, hjust=1)) +
xlab("Known") + ylab("Predicted") + ggtitle("Tran et. al. 2021") +
xlim(0,1) + ylim(0,1) +
facet_wrap(~cell.type*type)
plotK2.box.c2 <- ggplot(dfp.c2, aes(x = type, y = error)) +
geom_boxplot(color="cyan") + geom_jitter(alpha = 0.5) + theme_bw() +
theme(axis.text.x = element_text(angle = 45,hjust=1), axis.title.x = element_blank()) +
ylab("Error") + ggtitle("\n") + ylim(0, 0.3) + facet_wrap(~cell.type, nrow = 2)
dfp.c2 <- rbind(data.frame(true = dfp.tall.c2.k2$glial.true,
pred = dfp.tall.c2.k2$glial.pred,
cell.type = rep("glial", nrow(dfp.tall.c2.k2)),
type = dfp.tall.c2.k2$type,
error = dfp.tall.c2.k2$glial.abs.error),
data.frame(true = dfp.tall.c2.k2$neuron.true,
pred = dfp.tall.c2.k2$neuron.pred,
cell.type = rep("neuron", nrow(dfp.tall.c2.k2)),
type = dfp.tall.c2.k2$type,
error = dfp.tall.c2.k2$neuron.abs.error)) |>
as.data.frame()
dfp.c2
dfp.c2 <- ggplot(dfp.c2, aes(x = true, y = pred)) +
geom_point() + theme_bw() + geom_abline(slope = 1) +
theme(axis.text.x = element_text(angle = 45, hjust=1)) +
xlab("Known") + ylab("Predicted") + ggtitle("Tran et. al. 2021") +
xlim(0,1) + ylim(0,1) +
facet_wrap(~cell.type*type)
dfp.c2
plotK2.box.c2 <- ggplot(dfp.c2, aes(x = type, y = error)) +
geom_boxplot(color="cyan") + geom_jitter(alpha = 0.5) + theme_bw() +
theme(axis.text.x = element_text(angle = 45,hjust=1), axis.title.x = element_blank()) +
ylab("Error") + ggtitle("\n") + ylim(0, 0.3) + facet_wrap(~cell.type, nrow = 2)
head(dfp.c2)
class(dfp.c2)
plotK2.scatter.c2 <- ggplot(dfp.c2, aes(x = true, y = pred)) +
geom_point() + theme_bw() + geom_abline(slope = 1) +
theme(axis.text.x = element_text(angle = 45, hjust=1)) +
xlab("Known") + ylab("Predicted") + ggtitle("Tran et. al. 2021") +
xlim(0,1) + ylim(0,1) +
facet_wrap(~cell.type*type)
dfp.c2 <- rbind(data.frame(true = dfp.tall.c2.k2$glial.true,
pred = dfp.tall.c2.k2$glial.pred,
cell.type = rep("glial", nrow(dfp.tall.c2.k2)),
type = dfp.tall.c2.k2$type,
error = dfp.tall.c2.k2$glial.abs.error),
data.frame(true = dfp.tall.c2.k2$neuron.true,
pred = dfp.tall.c2.k2$neuron.pred,
cell.type = rep("neuron", nrow(dfp.tall.c2.k2)),
type = dfp.tall.c2.k2$type,
error = dfp.tall.c2.k2$neuron.abs.error)) |>
as.data.frame()
plotK2.scatter.c2 <- ggplot(dfp.c2, aes(x = true, y = pred)) +
geom_point() + theme_bw() + geom_abline(slope = 1) +
theme(axis.text.x = element_text(angle = 45, hjust=1)) +
xlab("Known") + ylab("Predicted") + ggtitle("Tran et. al. 2021") +
xlim(0,1) + ylim(0,1) +
facet_wrap(~cell.type*type)
plotK2.box.c2 <- ggplot(dfp.c2, aes(x = type, y = error)) +
geom_boxplot(color="cyan") + geom_jitter(alpha = 0.5) + theme_bw() +
theme(axis.text.x = element_text(angle = 45,hjust=1), axis.title.x = element_blank()) +
ylab("Error") + ggtitle("\n") + ylim(0, 0.3) + facet_wrap(~cell.type, nrow = 2)
matrix(c(rep(seq(4), each = 2)), nrow = 2, byrow=T)
matrix(rep(c(1,1,2,3,3,4), 2), nrow=2)
matrix(rep(c(1,1,2,3,3,4), 2), byrow=T, nrow=2)
layoutMatrix <- matrix(rep(c(1,1,2,3,3,4), 2), byrow=T, nrow=2)
grid.arrange(plotK2.scatter.c1,
plotK2.box.c1,
plotK2.scatter.c2,
plotK2.box.c2)
grid.arrange(plotK2.scatter.c1,
plotK2.box.c1,
plotK2.scatter.c2,
plotK2.box.c2,
layout_matrix = layoutMatrix)
dfp.c1 <- rbind(data.frame(true = dfp.tall.c1.k2$glial.true,
pred = dfp.tall.c1.k2$glial.pred,
cell.type = rep("glial", nrow(dfp.tall.c1.k2)),
type = dfp.tall.c1.k2$type,
error = dfp.tall.c1.k2$glial.abs.error),
data.frame(true = dfp.tall.c1.k2$neuron.true,
pred = dfp.tall.c1.k2$neuron.pred,
cell.type = rep("neuron", nrow(dfp.tall.c1.k2)),
type = dfp.tall.c1.k2$type,
error = dfp.tall.c1.k2$neuron.abs.error)) |>
as.data.frame()
plotK2.scatter.c1 <- ggplot(dfp.c1, aes(x = true, y = pred)) +
geom_point() + theme_bw() + geom_abline(slope = 1) +
theme(axis.text.x = element_text(angle = 45, hjust=1)) +
xlab("Known") + ylab("Predicted") + ggtitle("Huuki-Meyers et. al. 2023") +
xlim(0,1) + ylim(0,1) +
facet_wrap(~cell.type*type)
plotK2.box.c1 <- ggplot(dfp.c1, aes(x = type, y = error)) +
geom_boxplot(color="cyan") + geom_jitter(alpha = 0.5) + theme_bw() +
theme(axis.text.x = element_text(angle = 45,hjust=1), axis.title.x = element_blank()) +
ylab("Error") + ggtitle("\n") + ylim(0, 0.3) + facet_wrap(~cell.type, nrow = 2)
layoutMatrix <- matrix(rep(c(1,1,2,3,3,4), 2), byrow=T, nrow=2)
grid.arrange(plotK2.scatter.c1,
plotK2.box.c1,
plotK2.scatter.c2,
plotK2.box.c2,
layout_matrix = layoutMatrix)
setwd("..")
setwd("..")
jpeg("./figures/01_multipanel/pseudobulk-k2-2cohort_multi.jpg", width = 10, height = 4, units = "in", res = 400)
layoutMatrix <- matrix(rep(c(1,1,2,3,3,4), 2), byrow=T, nrow=2)
grid.arrange(plotK2.scatter.c1,
plotK2.box.c1,
plotK2.scatter.c2,
plotK2.box.c2,
layout_matrix = layoutMatrix)
dev.off()
gc()
gc()
gc()
libv <- c("here", "nlme", "lute", "ggplot2", "gridExtra",
"dplyr", "ggforce", "MultiAssayExperiment", "SingleCellExperiment")
sapply(libv, library, character.only = TRUE)
knitr::opts_chunk$set(echo = TRUE)
setwd("..")
setwd("..")
list.files()
load("env/01_multipanel/01_pseudobulk_script.RData")
head(dfp.tall.c1.k3)
dfp.c1 <- rbind(data.frame(true = dfp.tall.c1.k3$glial.true,
pred = dfp.tall.c1.k3$glial.pred,
cell.type = rep("glial", nrow(dfp.tall.c1.k3)),
type = dfp.tall.c1.k3$type,
error = dfp.tall.c1.32$glial.abs.error),
data.frame(true = dfp.tall.c1.k3$Excit.true,
pred = dfp.tall.c1.k3$Excit.pred,
cell.type = rep("Excit", nrow(dfp.tall.c1.k3)),
type = dfp.tall.c1.k3$type,
error = dfp.tall.c1.k3$Excit.abs.error),
data.frame(true = dfp.tall.c1.k3$Inhib.true,
pred = dfp.tall.c1.k3$Inhib.pred,
cell.type = rep("Inhib", nrow(dfp.tall.c1.k3)),
type = dfp.tall.c1.k3$type,
error = dfp.tall.c1.k3$Inhib.abs.error)) |>
as.data.frame()
dfp.tall.c1.k3$# cohort 1
dfp.c1 <- rbind(data.frame(true = dfp.tall.c1.k3$glial.true,
pred = dfp.tall.c1.k3$glial.pred,
cell.type = rep("glial", nrow(dfp.tall.c1.k3)),
type = dfp.tall.c1.k3$type,
error = dfp.tall.c1.3$glial.abs.error),
data.frame(true = dfp.tall.c1.k3$Excit.true,
pred = dfp.tall.c1.k3$Excit.pred,
cell.type = rep("Excit", nrow(dfp.tall.c1.k3)),
type = dfp.tall.c1.k3$type,
error = dfp.tall.c1.k3$Excit.abs.error),
data.frame(true = dfp.tall.c1.k3$Inhib.true,
pred = dfp.tall.c1.k3$Inhib.pred,
cell.type = rep("Inhib", nrow(dfp.tall.c1.k3)),
type = dfp.tall.c1.k3$type,
error = dfp.tall.c1.k3$Inhib.abs.error)) |>
as.data.frame()
# cohort 1
dfp.c1 <- rbind(data.frame(true = dfp.tall.c1.k3$glial.true,
pred = dfp.tall.c1.k3$glial.pred,
cell.type = rep("glial", nrow(dfp.tall.c1.k3)),
type = dfp.tall.c1.k3$type,
error = dfp.tall.c1.3$glial.abs.error),
data.frame(true = dfp.tall.c1.k3$Excit.true,
pred = dfp.tall.c1.k3$Excit.pred,
cell.type = rep("Excit", nrow(dfp.tall.c1.k3)),
type = dfp.tall.c1.k3$type,
error = dfp.tall.c1.k3$Excit.abs.error),
data.frame(true = dfp.tall.c1.k3$Inhib.true,
pred = dfp.tall.c1.k3$Inhib.pred,
cell.type = rep("Inhib", nrow(dfp.tall.c1.k3)),
type = dfp.tall.c1.k3$type,
error = dfp.tall.c1.k3$Inhib.abs.error)) |>
as.data.frame()
# cohort 1
dfp.c1 <- rbind(data.frame(true = dfp.tall.c1.k3$glial.true,
pred = dfp.tall.c1.k3$glial.pred,
cell.type = rep("glial", nrow(dfp.tall.c1.k3)),
type = dfp.tall.c1.k3$type,
error = dfp.tall.c1.k3$glial.abs.error),
data.frame(true = dfp.tall.c1.k3$Excit.true,
pred = dfp.tall.c1.k3$Excit.pred,
cell.type = rep("Excit", nrow(dfp.tall.c1.k3)),
type = dfp.tall.c1.k3$type,
error = dfp.tall.c1.k3$Excit.abs.error),
data.frame(true = dfp.tall.c1.k3$Inhib.true,
pred = dfp.tall.c1.k3$Inhib.pred,
cell.type = rep("Inhib", nrow(dfp.tall.c1.k3)),
type = dfp.tall.c1.k3$type,
error = dfp.tall.c1.k3$Inhib.abs.error)) |>
as.data.frame()
dfp.c2 <- rbind(data.frame(true = dfp.tall.c2.k3$glial.true,
pred = dfp.tall.c2.k3$glial.pred,
cell.type = rep("glial", nrow(dfp.tall.c2.k3)),
type = dfp.tall.c2.k3$type,
error = dfp.tall.c2.k3$glial.abs.error),
data.frame(true = dfp.tall.c2.k3$Excit.true,
pred = dfp.tall.c2.k3$Excit.pred,
cell.type = rep("Excit", nrow(dfp.tall.c2.k3)),
type = dfp.tall.c2.k3$type,
error = dfp.tall.c2.k3$Excit.abs.error),
data.frame(true = dfp.tall.c2.k3$Inhib.true,
pred = dfp.tall.c2.k3$Inhib.pred,
cell.type = rep("Inhib", nrow(dfp.tall.c2.k3)),
type = dfp.tall.c2.k3$type,
error = dfp.tall.c2.k3$Inhib.abs.error)) |>
as.data.frame()
plotK3.scatter.c1 <- ggplot(dfp.c1, aes(x = true, y = pred)) +
geom_point() + theme_bw() + geom_abline(slope = 1) +
theme(axis.text.x = element_text(angle = 45, hjust=1)) +
xlab("Known") + ylab("Predicted") + ggtitle("Huuki-Meyers et. al. 2023") +
xlim(0,1) + ylim(0,1) +
facet_wrap(~cell.type*type)
plotK3.scatter.c1
ggplot(dfp.c1, aes(x = true, y = pred)) +
geom_point() + theme_bw() + geom_abline(slope = 1) +
theme(axis.text.x = element_text(angle = 45, hjust=1)) +
xlab("Known") + ylab("Predicted") + ggtitle("Huuki-Meyers et. al. 2023") +
xlim(0,1) + ylim(0,1) +
facet_wrap(~type*cell.type)
ggplot(dfp.c1, aes(x = true, y = pred)) +
geom_point() + theme_bw() + geom_abline(slope = 1) +
theme(axis.text.x = element_text(angle = 45, hjust=1)) +
xlab("Known") + ylab("Predicted") + ggtitle("Huuki-Meyers et. al. 2023") +
xlim(0,1) + ylim(0,1) +
facet_wrap(~type*cell.type, ncol = 2)
ggplot(dfp.c1, aes(x = true, y = pred)) +
geom_point() + theme_bw() + geom_abline(slope = 1) +
theme(axis.text.x = element_text(angle = 45, hjust=1)) +
xlab("Known") + ylab("Predicted") + ggtitle("Huuki-Meyers et. al. 2023") +
xlim(0,1) + ylim(0,1) +
facet_wrap(~cell.type*type, ncol = 2)
dfp.c1$cell.type <- factor(dfp.c1$cell.type, levels = c("glial", "Excit", "Inhib"))
plotK3.scatter.c1 <- ggplot(dfp.c1, aes(x = true, y = pred)) +
geom_point() + theme_bw() + geom_abline(slope = 1) +
theme(axis.text.x = element_text(angle = 45, hjust=1)) +
xlab("Known") + ylab("Predicted") + ggtitle("Huuki-Meyers et. al. 2023") +
xlim(0,1) + ylim(0,1) +
facet_wrap(~cell.type*type, ncol = 2)
plotK3.scatter.c1
ggplot(dfp.c1, aes(x = type, y = error)) +
geom_boxplot(color="cyan") + geom_jitter(alpha = 0.5) + theme_bw() +
theme(axis.text.x = element_text(angle = 45,hjust=1), axis.title.x = element_blank()) +
ylab("Error") + ggtitle("\n") + ylim(0, 0.3) + facet_wrap(~cell.type, nrow = 3)
# cohort 2
dfp.c2 <- rbind(data.frame(true = dfp.tall.c2.k3$glial.true,
pred = dfp.tall.c2.k3$glial.pred,
cell.type = rep("glial", nrow(dfp.tall.c2.k3)),
type = dfp.tall.c2.k3$type,
error = dfp.tall.c2.k3$glial.abs.error),
data.frame(true = dfp.tall.c2.k3$Excit.true,
pred = dfp.tall.c2.k3$Excit.pred,
cell.type = rep("Excit", nrow(dfp.tall.c2.k3)),
type = dfp.tall.c2.k3$type,
error = dfp.tall.c2.k3$Excit.abs.error),
data.frame(true = dfp.tall.c2.k3$Inhib.true,
pred = dfp.tall.c2.k3$Inhib.pred,
cell.type = rep("Inhib", nrow(dfp.tall.c2.k3)),
type = dfp.tall.c2.k3$type,
error = dfp.tall.c2.k3$Inhib.abs.error)) |>
as.data.frame()
dfp.c2$cell.type <- factor(dfp.c2$cell.type, levels = c("glial", "Excit", "Inhib"))
plotK3.scatter.c2 <- ggplot(dfp.c2, aes(x = true, y = pred)) +
geom_point() + theme_bw() + geom_abline(slope = 1) +
theme(axis.text.x = element_text(angle = 45, hjust=1)) +
xlab("Known") + ylab("Predicted") + ggtitle("Huuki-Meyers et. al. 2023") +
xlim(0,1) + ylim(0,1) + facet_wrap(~cell.type*type, ncol = 2)
plotK3.box.c2 <- ggplot(dfp.c2, aes(x = type, y = error)) +
geom_boxplot(color="cyan") + geom_jitter(alpha = 0.5) + theme_bw() +
theme(axis.text.x = element_text(angle = 45,hjust=1), axis.title.x = element_blank()) +
ylab("Error") + ggtitle("\n") + ylim(0, 0.3) + facet_wrap(~cell.type, nrow = 3)
plotK3.scatter.c2
plotK3.box.c2
layoutMatrix <- matrix(rep(c(1,1,2,3,3,4), 2), byrow=T, nrow=2)
grid.arrange(plotK3.scatter.c1,
plotK3.box.c1,
plotK3.scatter.c2,
plotK3.box.c2,
layout_matrix = layoutMatrix)
# cohort 1
dfp.c1 <- rbind(data.frame(true = dfp.tall.c1.k3$glial.true,
pred = dfp.tall.c1.k3$glial.pred,
cell.type = rep("glial", nrow(dfp.tall.c1.k3)),
type = dfp.tall.c1.k3$type,
error = dfp.tall.c1.k3$glial.abs.error),
data.frame(true = dfp.tall.c1.k3$Excit.true,
pred = dfp.tall.c1.k3$Excit.pred,
cell.type = rep("Excit", nrow(dfp.tall.c1.k3)),
type = dfp.tall.c1.k3$type,
error = dfp.tall.c1.k3$Excit.abs.error),
data.frame(true = dfp.tall.c1.k3$Inhib.true,
pred = dfp.tall.c1.k3$Inhib.pred,
cell.type = rep("Inhib", nrow(dfp.tall.c1.k3)),
type = dfp.tall.c1.k3$type,
error = dfp.tall.c1.k3$Inhib.abs.error)) |>
as.data.frame()
dfp.c1$cell.type <- factor(dfp.c1$cell.type, levels = c("Excit", "Inhib", "glial"))
plotK3.scatter.c1 <- ggplot(dfp.c1, aes(x = true, y = pred)) +
geom_point() + theme_bw() + geom_abline(slope = 1) +
theme(axis.text.x = element_text(angle = 45, hjust=1)) +
xlab("Known") + ylab("Predicted") + ggtitle("Huuki-Meyers et. al. 2023") +
xlim(0,1) + ylim(0,1) +
facet_wrap(~cell.type*type, ncol = 2)
plotK3.box.c1 <- ggplot(dfp.c1, aes(x = type, y = error)) +
geom_boxplot(color="cyan") + geom_jitter(alpha = 0.5) + theme_bw() +
theme(axis.text.x = element_text(angle = 45,hjust=1), axis.title.x = element_blank()) +
ylab("Error") + ggtitle("\n") + ylim(0, 0.3) + facet_wrap(~cell.type, nrow = 3)
# cohort 2
dfp.c2 <- rbind(data.frame(true = dfp.tall.c2.k3$glial.true,
pred = dfp.tall.c2.k3$glial.pred,
cell.type = rep("glial", nrow(dfp.tall.c2.k3)),
type = dfp.tall.c2.k3$type,
error = dfp.tall.c2.k3$glial.abs.error),
data.frame(true = dfp.tall.c2.k3$Excit.true,
pred = dfp.tall.c2.k3$Excit.pred,
cell.type = rep("Excit", nrow(dfp.tall.c2.k3)),
type = dfp.tall.c2.k3$type,
error = dfp.tall.c2.k3$Excit.abs.error),
data.frame(true = dfp.tall.c2.k3$Inhib.true,
pred = dfp.tall.c2.k3$Inhib.pred,
cell.type = rep("Inhib", nrow(dfp.tall.c2.k3)),
type = dfp.tall.c2.k3$type,
error = dfp.tall.c2.k3$Inhib.abs.error)) |>
as.data.frame()
dfp.c2$cell.type <- factor(dfp.c2$cell.type, levels = c("Excit", "Inhib", "glial"))
plotK3.scatter.c2 <- ggplot(dfp.c2, aes(x = true, y = pred)) +
geom_point() + theme_bw() + geom_abline(slope = 1) +
theme(axis.text.x = element_text(angle = 45, hjust=1)) +
xlab("Known") + ylab("Predicted") + ggtitle("Huuki-Meyers et. al. 2023") +
xlim(0,1) + ylim(0,1) + facet_wrap(~cell.type*type, ncol = 2)
plotK3.box.c2 <- ggplot(dfp.c2, aes(x = type, y = error)) +
geom_boxplot(color="cyan") + geom_jitter(alpha = 0.5) + theme_bw() +
theme(axis.text.x = element_text(angle = 45,hjust=1), axis.title.x = element_blank()) +
ylab("Error") + ggtitle("\n") + ylim(0, 0.3) + facet_wrap(~cell.type, nrow = 3)
layoutMatrix <- matrix(rep(c(1,1,2,3,3,4), 2), byrow=T, nrow=2)
grid.arrange(plotK3.scatter.c1,
plotK3.box.c1,
plotK3.scatter.c2,
plotK3.box.c2,
layout_matrix = layoutMatrix)
# cohort 2
dfp.c2 <- rbind(data.frame(true = dfp.tall.c2.k3$glial.true,
pred = dfp.tall.c2.k3$glial.pred,
cell.type = rep("glial", nrow(dfp.tall.c2.k3)),
type = dfp.tall.c2.k3$type,
error = dfp.tall.c2.k3$glial.abs.error),
data.frame(true = dfp.tall.c2.k3$Excit.true,
pred = dfp.tall.c2.k3$Excit.pred,
cell.type = rep("Excit", nrow(dfp.tall.c2.k3)),
type = dfp.tall.c2.k3$type,
error = dfp.tall.c2.k3$Excit.abs.error),
data.frame(true = dfp.tall.c2.k3$Inhib.true,
pred = dfp.tall.c2.k3$Inhib.pred,
cell.type = rep("Inhib", nrow(dfp.tall.c2.k3)),
type = dfp.tall.c2.k3$type,
error = dfp.tall.c2.k3$Inhib.abs.error)) |>
as.data.frame()
dfp.c2$cell.type <- factor(dfp.c2$cell.type, levels = c("Excit", "Inhib", "glial"))
plotK3.scatter.c2 <- ggplot(dfp.c2, aes(x = true, y = pred)) +
geom_point() + theme_bw() + geom_abline(slope = 1) +
theme(axis.text.x = element_text(angle = 45, hjust=1)) +
xlab("Known") + ylab("Predicted") + ggtitle("Tran et. al. 2021") +
xlim(0,1) + ylim(0,1) + facet_wrap(~cell.type*type, ncol = 2)
plotK3.box.c2 <- ggplot(dfp.c2, aes(x = type, y = error)) +
geom_boxplot(color="cyan") + geom_jitter(alpha = 0.5) + theme_bw() +
theme(axis.text.x = element_text(angle = 45,hjust=1), axis.title.x = element_blank()) +
ylab("Error") + ggtitle("\n") + ylim(0, 0.3) + facet_wrap(~cell.type, nrow = 3)
setwd("..")
setwd("..")
jpeg("./figures/01_multipanel/pseudobulk-k3-2cohort_multi.jpg", width = 10, height = 4, units = "in", res = 400)
layoutMatrix <- matrix(rep(c(1,1,2,3,3,4), 2), byrow=T, nrow=2)
grid.arrange(plotK3.scatter.c1,
plotK3.box.c1,
plotK3.scatter.c2,
plotK3.box.c2,
layout_matrix = layoutMatrix)
dev.off()
